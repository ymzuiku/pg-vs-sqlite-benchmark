benchmark.log cleaned
ramp: 200 rampTims: 3
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /postgres/read
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────┬─────────────┬──────────┬─────────┬──────┬──────┬───────┬────────┬────────┬────────┬───────────┐
│ Case                   │ Concurrency │ Requests │ Success │ RPS  │ Min  │ 50%   │ 90%    │ 99%    │ Max    │ Test Time │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read          │ 200         │ 6524     │ 100.00% │ 1272 │ 55ms │ 144ms │ 165ms  │ 344ms  │ 1836ms │ 5.13s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/write         │ 200         │ 6607     │ 100.00% │ 1284 │ 1ms  │ 191ms │ 206ms  │ 264ms  │ 1229ms │ 5.14s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/rw            │ 200         │ 4623     │ 100.00% │ 913  │ 73ms │ 216ms │ 239ms  │ 272ms  │ 320ms  │ 5.06s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/indexed  │ 200         │ 13299    │ 100.00% │ 2624 │ 13ms │ 76ms  │ 84ms   │ 96ms   │ 122ms  │ 5.07s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/noindex  │ 200         │ 1176     │ 100.00% │ 199  │ 14ms │ 984ms │ 1016ms │ 1904ms │ 2940ms │ 5.92s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/count(*)      │ 200         │ 27027    │ 100.00% │ 5384 │ 9ms  │ 37ms  │ 41ms   │ 45ms   │ 106ms  │ 5.02s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /postgres/read         │ 200         │ 18057    │ 100.00% │ 3578 │ 45ms │ 55ms  │ 61ms   │ 68ms   │ 114ms  │ 5.05s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /postgres/write        │ 200         │ 35411    │ 100.00% │ 7041 │ 1ms  │ 34ms  │ 40ms   │ 61ms   │ 433ms  │ 5.03s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /postgres/rw           │ 200         │ 21525    │ 100.00% │ 4275 │ 24ms │ 46ms  │ 52ms   │ 63ms   │ 309ms  │ 5.04s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/indexed │ 200         │ 18618    │ 100.00% │ 3688 │ 8ms  │ 54ms  │ 58ms   │ 62ms   │ 73ms   │ 5.05s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/noindex │ 200         │ 5044     │ 100.00% │ 963  │ 23ms │ 199ms │ 253ms  │ 306ms  │ 357ms  │ 5.24s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼───────┼────────┼────────┼────────┼───────────┤
│ /postgres/count(*)     │ 200         │ 5280     │ 100.00% │ 1019 │ 27ms │ 189ms │ 242ms  │ 296ms  │ 351ms  │ 5.18s     │
└────────────────────────┴─────────────┴──────────┴─────────┴──────┴──────┴───────┴────────┴────────┴────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /postgres/read
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬────────┬────────┬────────┬────────┬───────────┐
│ Case                   │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%    │ 90%    │ 99%    │ Max    │ Test Time │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read          │ 400         │ 1915     │ 100.00% │ 306  │ 22ms  │ 716ms  │ 2103ms │ 6231ms │ 6241ms │ 6.25s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/write         │ 400         │ 6760     │ 100.00% │ 1301 │ 1ms   │ 340ms  │ 368ms  │ 1077ms │ 4799ms │ 5.20s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/rw            │ 400         │ 4620     │ 100.00% │ 884  │ 292ms │ 447ms  │ 489ms  │ 1511ms │ 1577ms │ 5.23s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/indexed  │ 400         │ 13998    │ 100.00% │ 2724 │ 10ms  │ 145ms  │ 162ms  │ 179ms  │ 895ms  │ 5.14s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/noindex  │ 400         │ 848      │ 100.00% │ 109  │ 19ms  │ 3606ms │ 3643ms │ 4098ms │ 4104ms │ 7.75s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/count(*)      │ 400         │ 26611    │ 100.00% │ 5211 │ 38ms  │ 73ms   │ 79ms   │ 112ms  │ 2196ms │ 5.11s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read         │ 400         │ 18912    │ 100.00% │ 3690 │ 1ms   │ 132ms  │ 149ms  │ 177ms  │ 244ms  │ 5.13s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/write        │ 400         │ 27880    │ 100.00% │ 5520 │ 24ms  │ 72ms   │ 78ms   │ 95ms   │ 373ms  │ 5.05s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/rw           │ 400         │ 20151    │ 100.00% │ 3971 │ 33ms  │ 100ms  │ 108ms  │ 116ms  │ 129ms  │ 5.08s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/indexed │ 400         │ 18168    │ 100.00% │ 3559 │ 12ms  │ 111ms  │ 119ms  │ 166ms  │ 227ms  │ 5.11s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/noindex │ 400         │ 2648     │ 100.00% │ 455  │ 40ms  │ 868ms  │ 940ms  │ 1000ms │ 1096ms │ 5.82s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/count(*)     │ 400         │ 4054     │ 100.00% │ 732  │ 58ms  │ 535ms  │ 596ms  │ 649ms  │ 736ms  │ 5.54s     │
└────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴────────┴────────┴────────┴────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /postgres/read
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬────────┬────────┬────────┬────────┬───────────┐
│ Case                   │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%    │ 90%    │ 99%    │ Max    │ Test Time │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read          │ 600         │ 1651     │ 100.00% │ 204  │ 26ms  │ 2420ms │ 3967ms │ 8041ms │ 8055ms │ 8.07s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/write         │ 600         │ 5774     │ 100.00% │ 1038 │ 60ms  │ 434ms  │ 515ms  │ 4978ms │ 5020ms │ 5.56s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/rw            │ 600         │ 4917     │ 100.00% │ 891  │ 235ms │ 606ms  │ 633ms  │ 4424ms │ 5382ms │ 5.52s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/indexed  │ 600         │ 13458    │ 100.00% │ 2573 │ 11ms  │ 230ms  │ 258ms  │ 269ms  │ 325ms  │ 5.23s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/noindex  │ 600         │ 1201     │ 100.00% │ 124  │ 29ms  │ 4409ms │ 4905ms │ 4920ms │ 6144ms │ 9.72s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/count(*)      │ 600         │ 33507    │ 100.00% │ 6609 │ 1ms   │ 76ms   │ 93ms   │ 108ms  │ 5013ms │ 5.07s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read         │ 600         │ 9660     │ 100.00% │ 1816 │ 54ms  │ 323ms  │ 349ms  │ 385ms  │ 429ms  │ 5.32s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/write        │ 600         │ 25330    │ 100.00% │ 4977 │ 26ms  │ 118ms  │ 129ms  │ 167ms  │ 411ms  │ 5.09s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/rw           │ 600         │ 20347    │ 100.00% │ 3986 │ 43ms  │ 149ms  │ 162ms  │ 171ms  │ 270ms  │ 5.11s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/indexed │ 600         │ 18596    │ 100.00% │ 3633 │ 16ms  │ 164ms  │ 182ms  │ 196ms  │ 668ms  │ 5.12s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/noindex │ 600         │ 1995     │ 97.59%  │ 330  │ 88ms  │ 2043ms │ 2182ms │ 2260ms │ 2321ms │ 5.90s     │
├────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/count(*)     │ 600         │ 3468     │ 100.00% │ 584  │ 44ms  │ 1009ms │ 1094ms │ 1167ms │ 1312ms │ 5.94s     │
└────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴────────┴────────┴────────┴────────┴───────────┘
--------------------------------
┌────────────────────────┬─────────────┬───────┬─────────┬──────┬─────┬──────┬──────┬──────┬──────┐
│ Name                   │ Concurrency │ Count │ Success │ RPS  │ Min │ 50%  │ 90%  │ Max  │ Time │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read          │ 200         │ 6524  │ 6524    │ 1272 │ 55  │ 144  │ 165  │ 1836 │ 5.13 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read          │ 400         │ 1915  │ 1915    │ 306  │ 22  │ 716  │ 2103 │ 6241 │ 6.25 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read          │ 600         │ 1651  │ 1651    │ 204  │ 26  │ 2420 │ 3967 │ 8055 │ 8.07 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/write         │ 200         │ 6607  │ 6607    │ 1284 │ 1   │ 191  │ 206  │ 1229 │ 5.14 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/write         │ 400         │ 6760  │ 6760    │ 1301 │ 1   │ 340  │ 368  │ 4799 │ 5.20 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/write         │ 600         │ 5774  │ 5774    │ 1038 │ 60  │ 434  │ 515  │ 5020 │ 5.56 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/rw            │ 200         │ 4623  │ 4623    │ 913  │ 73  │ 216  │ 239  │ 320  │ 5.06 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/rw            │ 400         │ 4620  │ 4620    │ 884  │ 292 │ 447  │ 489  │ 1577 │ 5.23 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/rw            │ 600         │ 4917  │ 4917    │ 891  │ 235 │ 606  │ 633  │ 5382 │ 5.52 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/indexed  │ 200         │ 13299 │ 13299   │ 2624 │ 13  │ 76   │ 84   │ 122  │ 5.07 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/indexed  │ 400         │ 13998 │ 13998   │ 2724 │ 10  │ 145  │ 162  │ 895  │ 5.14 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/indexed  │ 600         │ 13458 │ 13458   │ 2573 │ 11  │ 230  │ 258  │ 325  │ 5.23 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/noindex  │ 200         │ 1176  │ 1176    │ 199  │ 14  │ 984  │ 1016 │ 2940 │ 5.92 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/noindex  │ 400         │ 848   │ 848     │ 109  │ 19  │ 3606 │ 3643 │ 4104 │ 7.75 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/noindex  │ 600         │ 1201  │ 1201    │ 124  │ 29  │ 4409 │ 4905 │ 6144 │ 9.72 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/count(*)      │ 200         │ 27027 │ 27027   │ 5384 │ 9   │ 37   │ 41   │ 106  │ 5.02 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/count(*)      │ 400         │ 26611 │ 26611   │ 5211 │ 38  │ 73   │ 79   │ 2196 │ 5.11 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/count(*)      │ 600         │ 33507 │ 33507   │ 6609 │ 1   │ 76   │ 93   │ 5013 │ 5.07 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read         │ 200         │ 18057 │ 18057   │ 3578 │ 45  │ 55   │ 61   │ 114  │ 5.05 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read         │ 400         │ 18912 │ 18912   │ 3690 │ 1   │ 132  │ 149  │ 244  │ 5.13 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read         │ 600         │ 9660  │ 9660    │ 1816 │ 54  │ 323  │ 349  │ 429  │ 5.32 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/write        │ 200         │ 35411 │ 35411   │ 7041 │ 1   │ 34   │ 40   │ 433  │ 5.03 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/write        │ 400         │ 27880 │ 27880   │ 5520 │ 24  │ 72   │ 78   │ 373  │ 5.05 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/write        │ 600         │ 25330 │ 25330   │ 4977 │ 26  │ 118  │ 129  │ 411  │ 5.09 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/rw           │ 200         │ 21525 │ 21525   │ 4275 │ 24  │ 46   │ 52   │ 309  │ 5.04 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/rw           │ 400         │ 20151 │ 20151   │ 3971 │ 33  │ 100  │ 108  │ 129  │ 5.08 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/rw           │ 600         │ 20347 │ 20347   │ 3986 │ 43  │ 149  │ 162  │ 270  │ 5.11 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/indexed │ 200         │ 18618 │ 18618   │ 3688 │ 8   │ 54   │ 58   │ 73   │ 5.05 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/indexed │ 400         │ 18168 │ 18168   │ 3559 │ 12  │ 111  │ 119  │ 227  │ 5.11 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/indexed │ 600         │ 18596 │ 18596   │ 3633 │ 16  │ 164  │ 182  │ 668  │ 5.12 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/noindex │ 200         │ 5044  │ 5044    │ 963  │ 23  │ 199  │ 253  │ 357  │ 5.24 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/noindex │ 400         │ 2648  │ 2648    │ 455  │ 40  │ 868  │ 940  │ 1096 │ 5.82 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/noindex │ 600         │ 1995  │ 1947    │ 330  │ 88  │ 2043 │ 2182 │ 2321 │ 5.90 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/count(*)     │ 200         │ 5280  │ 5280    │ 1019 │ 27  │ 189  │ 242  │ 351  │ 5.18 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/count(*)     │ 400         │ 4054  │ 4054    │ 732  │ 58  │ 535  │ 596  │ 736  │ 5.54 │
├────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/count(*)     │ 600         │ 3468  │ 3468    │ 584  │ 44  │ 1009 │ 1094 │ 1312 │ 5.94 │
└────────────────────────┴─────────────┴───────┴─────────┴──────┴─────┴──────┴──────┴──────┴──────┘
--------------------------------
┌────────────────────────┬──────────┬──────────┬──────────┬───────┬─────────┬─────┬──────┬──────┬──────┬───────┐
│ Name                   │ 200C RPS │ 400C RPS │ 600C RPS │ Count │ Success │ Min │ 50%  │ 90%  │ Max  │ Time  │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read          │ 1272     │ 306      │ 204      │ 3363  │ 100%    │ 34  │ 1093 │ 2078 │ 5377 │ 19.45 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/write         │ 1284     │ 1301     │ 1038     │ 6380  │ 100%    │ 21  │ 322  │ 363  │ 3683 │ 15.90 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/rw            │ 913      │ 884      │ 891      │ 4720  │ 100%    │ 200 │ 423  │ 454  │ 2426 │ 15.81 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/indexed  │ 2624     │ 2724     │ 2573     │ 13585 │ 100%    │ 11  │ 150  │ 168  │ 447  │ 15.44 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/noindex  │ 199      │ 109      │ 124      │ 1075  │ 100%    │ 21  │ 3000 │ 3188 │ 4396 │ 23.39 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/count(*)      │ 5384     │ 5211     │ 6609     │ 29048 │ 100%    │ 16  │ 62   │ 71   │ 2438 │ 15.20 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read         │ 3578     │ 3690     │ 1816     │ 15543 │ 100%    │ 33  │ 170  │ 186  │ 262  │ 15.50 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/write        │ 7041     │ 5520     │ 4977     │ 29540 │ 100%    │ 17  │ 75   │ 82   │ 406  │ 15.17 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/rw           │ 4275     │ 3971     │ 3986     │ 20674 │ 100%    │ 33  │ 98   │ 107  │ 236  │ 15.23 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/indexed │ 3688     │ 3559     │ 3633     │ 18461 │ 100%    │ 12  │ 110  │ 120  │ 323  │ 15.28 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/noindex │ 963      │ 455      │ 330      │ 3229  │ 100%    │ 50  │ 1037 │ 1125 │ 1258 │ 16.96 │
├────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/count(*)     │ 1019     │ 732      │ 584      │ 4267  │ 100%    │ 43  │ 578  │ 644  │ 800  │ 16.66 │
└────────────────────────┴──────────┴──────────┴──────────┴───────┴─────────┴─────┴──────┴──────┴──────┴───────┘
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/1-RPS-vs-Concurrency.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/2-Degradation-Trend.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/3-Top10-Max-RPS.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/4-Top10-Lowest-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/5-RPS-vs-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/6-Performance-Radar.png
Server Version: unknown
Platform: linux
CPU Cores: 8
Memory (GB): 16
Total Time: 200.755s
🧠 Ask OpenAI for analysis...

✅ Analysis report:

## 接口性能概览

本报告分析了 Node.js 服务在不同并发数下，使用 SQLite 和 PostgreSQL 数据库的多个接口的性能表现。压测数据显示，PostgreSQL 数据库在大多数场景下表现优于 SQLite 数据库，尤其是在高并发下。  `/sqlite3/read/noindex` 和 `/sqlite3/read` 接口在并发增加时，延迟急剧上升，成为系统瓶颈。  `/postgres/read/noindex` 接口在高并发下也表现出较高的延迟。


| 接口名称             | 数据库     | 并发数 | RPS       | P50(ms) | P90(ms) | P99(ms) | Max(ms) | 备注                                     |
|----------------------|-------------|---------|-----------|---------|---------|---------|---------|-----------------------------------------|
| `/sqlite3/read`       | SQLite3     | 200     | 1272      | 144      | 165      | 344      | 1836     |                                         |
| `/sqlite3/read`       | SQLite3     | 400     | 306       | 716      | 2103     | 6231     | 6241     | 并发增加，延迟显著上升                 |
| `/sqlite3/read`       | SQLite3     | 600     | 204       | 2420     | 3967     | 8041     | 8055     | 并发增加，延迟急剧上升，性能严重下降 |
| `/sqlite3/read/noindex` | SQLite3     | 200     | 199       | 984      | 1016     | 1904     | 2940     | 无索引查询，延迟高                     |
| `/sqlite3/read/noindex` | SQLite3     | 400     | 109       | 3606     | 3643     | 4098     | 4104     | 无索引查询，高并发下延迟极高           |
| `/sqlite3/read/noindex` | SQLite3     | 600     | 124       | 4409     | 4905     | 4920     | 6144     | 无索引查询，高并发下延迟极高           |
| `/postgres/read/noindex` | PostgreSQL | 200     | 963       | 199      | 253      | 306      | 357      | 无索引查询，延迟相对较高             |
| `/postgres/read/noindex` | PostgreSQL | 400     | 455       | 868      | 940      | 1000     | 1096     | 无索引查询，高并发下延迟上升           |
| `/postgres/read/noindex` | PostgreSQL | 600     | 330       | 2043     | 2182     | 2260     | 2321     | 无索引查询，高并发下延迟上升           |


## 问题诊断

1. **SQLite 性能瓶颈：**  `/sqlite3/read` 和 `/sqlite3/read/noindex` 接口在高并发下性能急剧下降，主要原因是 SQLite 的单进程单线程架构限制了并发处理能力。随着并发数增加，数据库锁竞争加剧，导致大量请求排队等待，从而造成延迟激增。  `/sqlite3/read/noindex` 接口由于缺乏索引，导致数据库查询效率极低，进一步加剧了性能问题。

2. **PostgreSQL 性能表现：** PostgreSQL 作为多进程数据库，在高并发下表现相对稳定。但 `/postgres/read/noindex` 接口也存在无索引导致的性能问题，在高并发下延迟也明显增加。

3. **P99 延迟高：** 多个接口的 P99 延迟明显高于 P90，这表明存在少量请求的处理时间远高于平均水平，这可能是由数据库慢查询、GC 停顿或其他异常情况导致的。

4. **非线性缩放：**  SQLite 接口在并发数增加到 400 和 600 时，RPS 的增长速度明显放缓，甚至下降，这体现了单进程单线程数据库的瓶颈。PostgreSQL 的 RPS 增长相对平稳，但高并发下也存在性能下降趋势。


## 优化建议

1. **数据库选择和优化：**  对于高并发场景，强烈建议使用 PostgreSQL 替换 SQLite。SQLite 不适合高并发环境，其单线程架构限制了性能扩展性。  针对 PostgreSQL，应优化数据库查询语句，创建必要的索引，并监控慢查询。可以使用数据库 Profiler 工具 (如 pgAdmin 的查询分析功能) 定位慢查询。

2. **索引优化：**  所有读操作接口都应确保已创建合适的索引。  `/sqlite3/read/noindex` 和 `/postgres/read/noindex` 接口的性能问题直接源于缺乏索引。

3. **连接池管理：**  对于 PostgreSQL，使用连接池可以有效管理数据库连接，避免频繁创建和销毁连接带来的开销。

4. **缓存机制：**  引入缓存机制 (如 Redis) 可以显著提升读操作性能。对于频繁读取的数据，可以将其缓存到 Redis 中，减少对数据库的访问压力。

5. **异步处理：**  使用异步编程模型 (如 async/await 或 Promise) 可以避免阻塞主线程，提高并发处理能力。数据库操作尤其适合异步化处理。

6. **限流机制：**  在高并发情况下，可以引入限流机制 (如 Nginx 或 rate-limiter 中间件) 来保护后端服务，防止过载。

7. **代码优化：**  检查代码中是否存在性能瓶颈，例如不必要的循环、冗余计算等。可以使用 Node.js 的性能分析工具 (如 Chrome DevTools 的性能面板) 进行代码性能分析。

8. **水平扩展：**  将 Node.js 服务进行水平扩展，部署多个实例，通过负载均衡器分发请求，可以提高系统的整体吞吐率和并发处理能力。

9. **监控和报警：**  使用 APM 工具 (如 Prometheus, Grafana) 监控系统的各项指标，例如 CPU 使用率、内存使用率、数据库连接数、请求延迟等，及时发现和解决性能问题。设置报警机制，以便在系统出现异常时及时响应。


## 优先级排序

1. **数据库迁移到 PostgreSQL:**  这是最优先级最高的优化，直接解决 SQLite 的单线程瓶颈。
2. **创建索引:**  针对所有读操作接口，特别是目前无索引的接口，创建必要的索引。
3. **引入缓存机制 (Redis):**  显著提升读操作性能，降低数据库压力。
4. **异步化数据库操作:**  避免阻塞主线程，提高并发处理能力。
5. **连接池优化:**  有效管理数据库连接，减少开销。
6. **水平扩展 Node.js 服务:**  提高系统整体吞吐率和并发处理能力。
7. **代码性能优化:**  针对性能瓶颈代码进行优化。
8. **限流机制:**  保护后端服务，防止过载。
9. **监控和报警:**  及时发现和解决性能问题。


## 分析总结

本次压测结果表明，当前系统在高并发下存在明显的性能瓶颈，主要原因是使用了不适合高并发场景的 SQLite 数据库以及部分接口缺乏索引。  通过迁移到 PostgreSQL 数据库、创建索引、引入缓存和异步处理等优化措施，可以显著提升系统的性能和稳定性。  建议使用 APM 工具、数据库 Profiler 和代码性能分析工具进行更深入的性能诊断和优化。  持续监控系统指标，及时发现和解决潜在问题，对于保证系统稳定运行至关重要。

--------------------------------
✅ Benchmark finished, all results are saved in benchmark-output folder
--------------------------------
