benchmark.log cleaned
ramp: 200 rampTims: 3
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬───────┬───────┬────────┬────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%   │ 90%   │ 99%    │ Max    │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /sqlite3/read/complicated  │ 200         │ 5368     │ 100.00% │ 1231 │ 44ms  │ 134ms │ 160ms │ 1196ms │ 2934ms │ 4.36s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /sqlite3/write             │ 200         │ 4506     │ 100.00% │ 1012 │ 57ms  │ 191ms │ 213ms │ 260ms  │ 1736ms │ 4.45s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /sqlite3/rw                │ 200         │ 4007     │ 100.00% │ 905  │ 143ms │ 215ms │ 237ms │ 270ms  │ 300ms  │ 4.43s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /sqlite3/read/indexed      │ 200         │ 12421    │ 100.00% │ 2857 │ 8ms   │ 70ms  │ 78ms  │ 87ms   │ 100ms  │ 4.35s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /sqlite3/read/noindex      │ 200         │ 1165     │ 100.00% │ 245  │ 13ms  │ 740ms │ 818ms │ 3893ms │ 3934ms │ 4.76s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /sqlite3/count(*)          │ 200         │ 30668    │ 100.00% │ 7111 │ 1ms   │ 37ms  │ 40ms  │ 45ms   │ 378ms  │ 4.31s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /sqlite3/read/pages        │ 200         │ 16018    │ 100.00% │ 3694 │ 18ms  │ 53ms  │ 62ms  │ 71ms   │ 89ms   │ 4.34s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /postgres/read/complicated │ 200         │ 15931    │ 100.00% │ 3675 │ 39ms  │ 53ms  │ 60ms  │ 68ms   │ 124ms  │ 4.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /postgres/write            │ 200         │ 23839    │ 100.00% │ 5520 │ 7ms   │ 35ms  │ 40ms  │ 50ms   │ 605ms  │ 4.32s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /postgres/rw               │ 200         │ 18417    │ 100.00% │ 4258 │ 24ms  │ 47ms  │ 52ms  │ 65ms   │ 89ms   │ 4.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /postgres/read/indexed     │ 200         │ 16061    │ 100.00% │ 3712 │ 9ms   │ 53ms  │ 59ms  │ 71ms   │ 906ms  │ 4.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /postgres/read/noindex     │ 200         │ 2833     │ 100.00% │ 621  │ 36ms  │ 318ms │ 378ms │ 434ms  │ 502ms  │ 4.56s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /postgres/count(*)         │ 200         │ 23755    │ 100.00% │ 5491 │ 1ms   │ 47ms  │ 59ms  │ 75ms   │ 112ms  │ 4.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼───────┼───────┼────────┼────────┼───────────┤
│ /postgres/read/pages       │ 200         │ 15839    │ 100.00% │ 3656 │ 5ms   │ 54ms  │ 57ms  │ 62ms   │ 66ms   │ 4.33s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴───────┴───────┴────────┴────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬────────┬────────┬────────┬────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%    │ 90%    │ 99%    │ Max    │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/complicated  │ 400         │ 1854     │ 100.00% │ 358  │ 24ms  │ 573ms  │ 4581ms │ 5054ms │ 5168ms │ 5.18s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/write             │ 400         │ 4654     │ 100.00% │ 1009 │ 44ms  │ 318ms  │ 376ms  │ 4199ms │ 4233ms │ 4.61s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/rw                │ 400         │ 4150     │ 100.00% │ 921  │ 185ms │ 413ms  │ 440ms  │ 1200ms │ 4050ms │ 4.51s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/indexed      │ 400         │ 12769    │ 100.00% │ 2888 │ 9ms   │ 138ms  │ 152ms  │ 173ms  │ 201ms  │ 4.42s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/noindex      │ 400         │ 845      │ 100.00% │ 127  │ 18ms  │ 3075ms │ 3539ms │ 3553ms │ 3734ms │ 6.64s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/count(*)          │ 400         │ 30875    │ 100.00% │ 7137 │ 1ms   │ 71ms   │ 79ms   │ 85ms   │ 1064ms │ 4.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/pages        │ 400         │ 16068    │ 100.00% │ 3672 │ 27ms  │ 107ms  │ 126ms  │ 136ms  │ 166ms  │ 4.38s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/complicated │ 400         │ 15323    │ 100.00% │ 3502 │ 43ms  │ 112ms  │ 131ms  │ 153ms  │ 236ms  │ 4.38s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/write            │ 400         │ 23415    │ 100.00% │ 5375 │ 28ms  │ 74ms   │ 80ms   │ 92ms   │ 144ms  │ 4.36s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/rw               │ 400         │ 17377    │ 100.00% │ 3991 │ 33ms  │ 99ms   │ 110ms  │ 137ms  │ 147ms  │ 4.35s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/indexed     │ 400         │ 15442    │ 100.00% │ 3522 │ 9ms   │ 113ms  │ 121ms  │ 135ms  │ 260ms  │ 4.38s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/noindex     │ 400         │ 2763     │ 100.00% │ 558  │ 26ms  │ 705ms  │ 770ms  │ 816ms  │ 849ms  │ 4.95s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/count(*)         │ 400         │ 15090    │ 100.00% │ 3401 │ 1ms   │ 152ms  │ 170ms  │ 192ms  │ 242ms  │ 4.44s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/pages       │ 400         │ 15124    │ 100.00% │ 3444 │ 8ms   │ 115ms  │ 120ms  │ 142ms  │ 231ms  │ 4.39s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴────────┴────────┴────────┴────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬────────┬────────┬────────┬────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%    │ 90%    │ 99%    │ Max    │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/complicated  │ 600         │ 1095     │ 100.00% │ 185  │ 26ms  │ 2293ms │ 5606ms │ 5834ms │ 5903ms │ 5.92s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/write             │ 600         │ 4970     │ 100.00% │ 1058 │ 39ms  │ 428ms  │ 590ms  │ 4045ms │ 4084ms │ 4.70s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/rw                │ 600         │ 4175     │ 100.00% │ 915  │ 265ms │ 618ms  │ 653ms  │ 2883ms │ 4200ms │ 4.56s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/indexed      │ 600         │ 12461    │ 100.00% │ 2788 │ 13ms  │ 211ms  │ 236ms  │ 269ms  │ 723ms  │ 4.47s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/noindex      │ 600         │ 718      │ 100.00% │ 103  │ 25ms  │ 5581ms │ 5592ms │ 5595ms │ 5625ms │ 6.96s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/count(*)          │ 600         │ 22791    │ 100.00% │ 5233 │ 16ms  │ 104ms  │ 112ms  │ 155ms  │ 2889ms │ 4.36s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/pages        │ 600         │ 15840    │ 100.00% │ 3552 │ 15ms  │ 165ms  │ 196ms  │ 214ms  │ 263ms  │ 4.46s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/complicated │ 600         │ 10525    │ 100.00% │ 2332 │ 53ms  │ 252ms  │ 277ms  │ 311ms  │ 349ms  │ 4.51s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/write            │ 600         │ 21651    │ 100.00% │ 4934 │ 20ms  │ 120ms  │ 131ms  │ 157ms  │ 508ms  │ 4.39s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/rw               │ 600         │ 17090    │ 100.00% │ 3886 │ 48ms  │ 153ms  │ 165ms  │ 176ms  │ 244ms  │ 4.40s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/indexed     │ 600         │ 21256    │ 100.00% │ 4797 │ 1ms   │ 162ms  │ 173ms  │ 182ms  │ 272ms  │ 4.43s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/noindex     │ 600         │ 2123     │ 100.00% │ 356  │ 53ms  │ 1632ms │ 1733ms │ 1833ms │ 1899ms │ 5.96s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/count(*)         │ 600         │ 3845     │ 100.00% │ 766  │ 40ms  │ 770ms  │ 840ms  │ 893ms  │ 943ms  │ 5.02s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/pages       │ 600         │ 15520    │ 100.00% │ 3499 │ 11ms  │ 171ms  │ 178ms  │ 184ms  │ 312ms  │ 4.43s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴────────┴────────┴────────┴────────┴───────────┘
--------------------------------
┌────────────────────────────┬─────────────┬───────┬─────────┬──────┬─────┬──────┬──────┬──────┬──────┐
│ Name                       │ Concurrency │ Count │ Success │ RPS  │ Min │ 50%  │ 90%  │ Max  │ Time │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/complicated  │ 200         │ 5368  │ 5368    │ 1231 │ 44  │ 134  │ 160  │ 2934 │ 4.36 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/complicated  │ 400         │ 1854  │ 1854    │ 358  │ 24  │ 573  │ 4581 │ 5168 │ 5.18 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/complicated  │ 600         │ 1095  │ 1095    │ 185  │ 26  │ 2293 │ 5606 │ 5903 │ 5.92 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/write             │ 200         │ 4506  │ 4506    │ 1012 │ 57  │ 191  │ 213  │ 1736 │ 4.45 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/write             │ 400         │ 4654  │ 4654    │ 1009 │ 44  │ 318  │ 376  │ 4233 │ 4.61 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/write             │ 600         │ 4970  │ 4970    │ 1058 │ 39  │ 428  │ 590  │ 4084 │ 4.70 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/rw                │ 200         │ 4007  │ 4007    │ 905  │ 143 │ 215  │ 237  │ 300  │ 4.43 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/rw                │ 400         │ 4150  │ 4150    │ 921  │ 185 │ 413  │ 440  │ 4050 │ 4.51 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/rw                │ 600         │ 4175  │ 4175    │ 915  │ 265 │ 618  │ 653  │ 4200 │ 4.56 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/indexed      │ 200         │ 12421 │ 12421   │ 2857 │ 8   │ 70   │ 78   │ 100  │ 4.35 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/indexed      │ 400         │ 12769 │ 12769   │ 2888 │ 9   │ 138  │ 152  │ 201  │ 4.42 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/indexed      │ 600         │ 12461 │ 12461   │ 2788 │ 13  │ 211  │ 236  │ 723  │ 4.47 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/noindex      │ 200         │ 1165  │ 1165    │ 245  │ 13  │ 740  │ 818  │ 3934 │ 4.76 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/noindex      │ 400         │ 845   │ 845     │ 127  │ 18  │ 3075 │ 3539 │ 3734 │ 6.64 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/noindex      │ 600         │ 718   │ 718     │ 103  │ 25  │ 5581 │ 5592 │ 5625 │ 6.96 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/count(*)          │ 200         │ 30668 │ 30668   │ 7111 │ 1   │ 37   │ 40   │ 378  │ 4.31 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/count(*)          │ 400         │ 30875 │ 30875   │ 7137 │ 1   │ 71   │ 79   │ 1064 │ 4.33 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/count(*)          │ 600         │ 22791 │ 22791   │ 5233 │ 16  │ 104  │ 112  │ 2889 │ 4.36 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/pages        │ 200         │ 16018 │ 16018   │ 3694 │ 18  │ 53   │ 62   │ 89   │ 4.34 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/pages        │ 400         │ 16068 │ 16068   │ 3672 │ 27  │ 107  │ 126  │ 166  │ 4.38 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /sqlite3/read/pages        │ 600         │ 15840 │ 15840   │ 3552 │ 15  │ 165  │ 196  │ 263  │ 4.46 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/complicated │ 200         │ 15931 │ 15931   │ 3675 │ 39  │ 53   │ 60   │ 124  │ 4.33 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/complicated │ 400         │ 15323 │ 15323   │ 3502 │ 43  │ 112  │ 131  │ 236  │ 4.38 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/complicated │ 600         │ 10525 │ 10525   │ 2332 │ 53  │ 252  │ 277  │ 349  │ 4.51 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/write            │ 200         │ 23839 │ 23839   │ 5520 │ 7   │ 35   │ 40   │ 605  │ 4.32 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/write            │ 400         │ 23415 │ 23415   │ 5375 │ 28  │ 74   │ 80   │ 144  │ 4.36 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/write            │ 600         │ 21651 │ 21651   │ 4934 │ 20  │ 120  │ 131  │ 508  │ 4.39 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/rw               │ 200         │ 18417 │ 18417   │ 4258 │ 24  │ 47   │ 52   │ 89   │ 4.33 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/rw               │ 400         │ 17377 │ 17377   │ 3991 │ 33  │ 99   │ 110  │ 147  │ 4.35 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/rw               │ 600         │ 17090 │ 17090   │ 3886 │ 48  │ 153  │ 165  │ 244  │ 4.40 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/indexed     │ 200         │ 16061 │ 16061   │ 3712 │ 9   │ 53   │ 59   │ 906  │ 4.33 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/indexed     │ 400         │ 15442 │ 15442   │ 3522 │ 9   │ 113  │ 121  │ 260  │ 4.38 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/indexed     │ 600         │ 21256 │ 21256   │ 4797 │ 1   │ 162  │ 173  │ 272  │ 4.43 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/noindex     │ 200         │ 2833  │ 2833    │ 621  │ 36  │ 318  │ 378  │ 502  │ 4.56 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/noindex     │ 400         │ 2763  │ 2763    │ 558  │ 26  │ 705  │ 770  │ 849  │ 4.95 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/noindex     │ 600         │ 2123  │ 2123    │ 356  │ 53  │ 1632 │ 1733 │ 1899 │ 5.96 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/count(*)         │ 200         │ 23755 │ 23755   │ 5491 │ 1   │ 47   │ 59   │ 112  │ 4.33 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/count(*)         │ 400         │ 15090 │ 15090   │ 3401 │ 1   │ 152  │ 170  │ 242  │ 4.44 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/count(*)         │ 600         │ 3845  │ 3845    │ 766  │ 40  │ 770  │ 840  │ 943  │ 5.02 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/pages       │ 200         │ 15839 │ 15839   │ 3656 │ 5   │ 54   │ 57   │ 66   │ 4.33 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/pages       │ 400         │ 15124 │ 15124   │ 3444 │ 8   │ 115  │ 120  │ 231  │ 4.39 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼──────┼──────┼──────┼──────┤
│ /postgres/read/pages       │ 600         │ 15520 │ 15520   │ 3499 │ 11  │ 171  │ 178  │ 312  │ 4.43 │
└────────────────────────────┴─────────────┴───────┴─────────┴──────┴─────┴──────┴──────┴──────┴──────┘
--------------------------------
┌────────────────────────────┬──────────┬──────────┬──────────┬───────┬─────────┬─────┬──────┬──────┬──────┬───────┐
│ Name                       │ 200C RPS │ 400C RPS │ 600C RPS │ Count │ Success │ Min │ 50%  │ 90%  │ Max  │ Time  │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/complicated  │ 1231     │ 358      │ 185      │ 2772  │ 100%    │ 31  │ 1000 │ 3449 │ 4668 │ 15.46 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/write             │ 1012     │ 1009     │ 1058     │ 4710  │ 100%    │ 47  │ 312  │ 393  │ 3351 │ 13.76 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/rw                │ 905      │ 921      │ 915      │ 4111  │ 100%    │ 198 │ 415  │ 443  │ 2850 │ 13.50 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/indexed      │ 2857     │ 2888     │ 2788     │ 12550 │ 100%    │ 10  │ 140  │ 155  │ 341  │ 13.24 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/noindex      │ 245      │ 127      │ 103      │ 909   │ 100%    │ 19  │ 3132 │ 3316 │ 4431 │ 18.36 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/count(*)          │ 7111     │ 7137     │ 5233     │ 28111 │ 100%    │ 6   │ 71   │ 77   │ 1444 │ 13.00 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/pages        │ 3694     │ 3672     │ 3552     │ 15975 │ 100%    │ 20  │ 108  │ 128  │ 173  │ 13.18 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/complicated │ 3675     │ 3502     │ 2332     │ 13926 │ 100%    │ 45  │ 139  │ 156  │ 236  │ 13.22 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/write            │ 5520     │ 5375     │ 4934     │ 22968 │ 100%    │ 18  │ 76   │ 84   │ 419  │ 13.07 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/rw               │ 4258     │ 3991     │ 3886     │ 17628 │ 100%    │ 35  │ 100  │ 109  │ 160  │ 13.08 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/indexed     │ 3712     │ 3522     │ 4797     │ 17586 │ 100%    │ 6   │ 109  │ 118  │ 479  │ 13.14 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/noindex     │ 621      │ 558      │ 356      │ 2573  │ 100%    │ 38  │ 885  │ 960  │ 1083 │ 15.47 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/count(*)         │ 5491     │ 3401     │ 766      │ 14230 │ 100%    │ 14  │ 323  │ 356  │ 432  │ 13.79 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/pages       │ 3656     │ 3444     │ 3499     │ 15494 │ 100%    │ 8   │ 113  │ 118  │ 203  │ 13.15 │
└────────────────────────────┴──────────┴──────────┴──────────┴───────┴─────────┴─────┴──────┴──────┴──────┴───────┘
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/1-RPS-vs-Concurrency.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/2-Degradation-Trend.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/3-Top10-Max-RPS.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/4-Top10-Lowest-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/5-RPS-vs-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/6-Performance-Radar.png
Server Version: unknown
Platform: linux
CPU Cores: 8
Memory (GB): 16
Total Time: 196.318s
🧠 Ask OpenAI for analysis...

✅ Analysis report:

## 接口性能概览

本报告分析了 Node.js 服务在不同并发下，使用 SQLite 和 PostgreSQL 数据库的 12 个接口的性能表现。压测结果显示，数据库选择和索引使用对性能影响显著。  `/sqlite3/count(*)` 和 `/postgres/write` 接口在高并发下表现突出，而 `/sqlite3/read/noindex` 和 `/postgres/read/noindex` 接口在所有并发级别下都表现最差，成为明显的瓶颈。  SQLite 的读写混合接口 (`/sqlite3/rw`) 也显示出性能瓶颈。

| 接口名称                     | 数据库 | 并发200 RPS | 并发400 RPS | 并发600 RPS | P99延迟(并发200) | P99延迟(并发400) | P99延迟(并发600) | 延迟趋势 |
|------------------------------|--------|------------|------------|------------|-----------------|-----------------|-----------------|-------------|
| `/sqlite3/read/complicated` | sqlite3 | 1231       | 358        | 185        | 1196             | 5054            | 5834            | 急剧下降   |
| `/sqlite3/write`             | sqlite3 | 1012       | 1009       | 1058       | 260              | 4199            | 4045            | 缓慢下降   |
| `/sqlite3/rw`                | sqlite3 | 905        | 921        | 915        | 270              | 1200            | 2883            | 缓慢下降   |
| `/sqlite3/read/indexed`      | sqlite3 | 2857       | 2888       | 2788       | 87               | 173             | 269             | 缓慢下降   |
| `/sqlite3/read/noindex`      | sqlite3 | 245        | 127        | 103        | 3893             | 3553            | 5595            | 急剧下降   |
| `/sqlite3/count(*)`          | sqlite3 | 7111       | 7137       | 5233       | 45               | 85              | 155             | 缓慢下降   |
| `/sqlite3/read/pages`        | sqlite3 | 3694       | 3672       | 3552       | 71               | 136             | 214             | 缓慢下降   |
| `/postgres/read/complicated` | postgres | 3675       | 3502       | 2332       | 68               | 153             | 311             | 缓慢下降   |
| `/postgres/write`            | postgres | 5520       | 5375       | 4934       | 50               | 92              | 157             | 缓慢下降   |
| `/postgres/rw`               | postgres | 4258       | 3991       | 3886       | 65               | 137             | 176             | 缓慢下降   |
| `/postgres/read/indexed`     | postgres | 3712       | 3522       | 4797       | 71               | 135             | 182             | 缓慢下降   |
| `/postgres/read/noindex`     | postgres | 621        | 558        | 356        | 434              | 816             | 1833            | 缓慢下降   |
| `/postgres/count(*)`         | postgres | 5491       | 3401       | 766        | 75               | 192             | 893             | 急剧下降   |
| `/postgres/read/pages`       | postgres | 3656       | 3444       | 3499       | 62               | 142             | 184             | 缓慢下降   |


## 问题诊断

1. **SQLite 性能瓶颈:**  `/sqlite3/read/complicated`, `/sqlite3/read/noindex`, `/sqlite3/write` 和 `/sqlite3/rw` 接口在并发增加时，RPS 下降明显，P99 延迟急剧增加。这表明 SQLite 在高并发下存在严重的性能瓶颈。  原因可能是 SQLite 的单进程单线程架构限制了并发处理能力，以及索引缺失导致的全文扫描。`/sqlite3/read/noindex` 的表现尤其糟糕，这直接印证了索引的重要性。  `complicated` 接口的性能下降可能由于其复杂的SQL查询导致。`rw` 接口的性能下降可能由于读写操作的锁竞争。

2. **PostgreSQL 性能瓶颈:**  `/postgres/read/noindex` 和 `/postgres/count(*)` 接口在高并发下表现不佳，P99 延迟显著高于 P90，说明存在潜在的数据库瓶颈或查询优化问题。  `/postgres/count(*)` 接口在并发600时RPS下降明显，这可能与数据库连接池或查询计划有关。 `noindex` 接口的性能问题同样源于索引缺失。

3. **索引的重要性:**  对比 `/sqlite3/read/indexed` 和 `/sqlite3/read/noindex`，以及 `/postgres/read/indexed` 和 `/postgres/read/noindex` 可以清晰地看到索引对读操作性能的巨大提升。  无索引的读取操作导致了全表扫描，严重影响性能。

4. **数据库连接池:**  虽然 PostgreSQL 比 SQLite 性能更好，但在高并发下，仍然存在 RPS 下降和延迟增加的情况，这暗示着数据库连接池的设置可能需要调整，以应对更高的并发请求。

5. **非线性缩放:**  多个接口在并发从 200 增加到 400，甚至 600 时，RPS 的增长并非线性，而是呈现出明显的下降趋势，这说明系统已经接近或达到了其处理能力的极限，可能存在 CPU、IO 或数据库连接等资源瓶颈。


## 优化建议

1. **数据库选择:**  对于高并发场景，建议优先使用 PostgreSQL，因为它具有更好的并发处理能力和性能。  SQLite 适用于低并发、数据量小的应用场景。

2. **索引优化:**  对所有数据库表进行全面的索引优化，特别是频繁查询的字段。  确保唯一索引和普通索引的合理使用。  可以使用数据库的性能分析工具来分析查询计划，并识别需要添加索引的字段。

3. **数据库连接池配置:**  调整 PostgreSQL 的连接池配置，增加最大连接数，并根据实际情况调整连接超时时间和空闲连接回收策略。

4. **查询优化:**  对复杂的 SQL 查询进行优化，减少数据库的负载。  可以使用数据库的性能分析工具来分析查询性能，并识别需要优化的查询。  例如，对于 `/sqlite3/read/complicated` 接口，需要审查其SQL语句，考虑使用更有效的查询方式。

5. **缓存策略:**  引入缓存机制，例如 Redis，缓存频繁访问的数据，减少数据库的访问压力。  可以缓存 `/sqlite3/read/pages` 和 `/postgres/read/pages` 等接口的结果。

6. **异步处理:**  将耗时的数据库操作异步化，例如使用消息队列（如 RabbitMQ 或 Kafka）将数据库操作异步处理，避免阻塞主线程。

7. **限流:**  对于高并发场景，可以引入限流机制，限制单位时间内的请求数量，防止系统过载。

8. **代码优化:**  检查代码是否存在性能瓶颈，例如不必要的循环、冗余计算等。  可以使用 Node.js 的性能分析工具（如 Node.js Profiler）来定位代码性能瓶颈。

9. **水平扩展:**  考虑将 Node.js 服务进行水平扩展，增加服务器数量，提高系统的处理能力。  可以使用负载均衡器来分发请求。

10. **监控和告警:**  部署完善的监控和告警系统，实时监控系统的性能指标，例如 CPU 使用率、内存使用率、数据库连接数、请求延迟等。  一旦发现异常情况，及时进行处理。


## 优先级排序

1. **添加索引到 `/sqlite3/read/noindex` 和 `/postgres/read/noindex` 接口对应的表中:**  这是最直接、见效最快的优化措施。
2. **优化 `/sqlite3/read/complicated` 接口的 SQL 查询:**  减少数据库负载。
3. **升级数据库到 PostgreSQL 并优化连接池配置:**  解决 SQLite 的单线程瓶颈。
4. **引入 Redis 缓存:**  减少数据库访问压力。
5. **异步化数据库操作:**  提高并发处理能力。
6. **水平扩展 Node.js 服务:**  提高系统吞吐量。


## 分析总结

本次压测结果表明，当前系统在高并发下存在明显的性能瓶颈，主要体现在 SQLite 数据库的单线程限制和部分接口的索引缺失以及复杂的SQL查询。  PostgreSQL 表现相对较好，但仍需优化连接池配置和部分查询。  通过数据库选择、索引优化、缓存、异步处理、限流以及水平扩展等多种优化手段，可以显著提升系统的性能和稳定性。  建议使用数据库性能分析工具和 Node.js 性能分析工具来进一步定位问题，并验证优化效果。

--------------------------------
✅ Benchmark finished, all results are saved in benchmark-output folder
--------------------------------
