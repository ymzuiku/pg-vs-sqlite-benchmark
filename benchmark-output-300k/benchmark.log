ramp: 200 rampTims: 3
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬─────────┬─────────┬─────────┬─────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%     │ 90%     │ 99%     │ Max     │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/complicated  │ 200         │ 247      │ 100.00% │ 25   │ 194ms │ 7821ms  │ 7832ms  │ 7855ms  │ 8847ms  │ 9.76s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/write             │ 200         │ 4305     │ 100.00% │ 984  │ 41ms  │ 168ms   │ 195ms   │ 2097ms  │ 3692ms  │ 4.37s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/rw                │ 200         │ 3855     │ 100.00% │ 881  │ 96ms  │ 222ms   │ 274ms   │ 284ms   │ 848ms   │ 4.38s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/indexed      │ 200         │ 835      │ 100.00% │ 167  │ 17ms  │ 1504ms  │ 1541ms  │ 1746ms  │ 2618ms  │ 4.99s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/noindex      │ 200         │ 255      │ 94.90%  │ 14   │ 81ms  │ 14428ms │ 14437ms │ 14440ms │ 14441ms │ 17.42s    │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/count(*)          │ 200         │ 4817     │ 100.00% │ 1083 │ 11ms  │ 169ms   │ 189ms   │ 1101ms  │ 2915ms  │ 4.45s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/pages        │ 200         │ 14892    │ 100.00% │ 3439 │ 16ms  │ 56ms    │ 69ms    │ 82ms    │ 105ms   │ 4.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/complicated │ 200         │ 5021     │ 100.00% │ 1116 │ 1ms   │ 225ms   │ 282ms   │ 335ms   │ 420ms   │ 4.50s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/write            │ 200         │ 23772    │ 100.00% │ 5519 │ 17ms  │ 35ms    │ 42ms    │ 55ms    │ 287ms   │ 4.31s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/rw               │ 200         │ 17402    │ 100.00% │ 4029 │ 22ms  │ 48ms    │ 54ms    │ 79ms    │ 149ms   │ 4.32s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/indexed     │ 200         │ 12866    │ 100.00% │ 2966 │ 16ms  │ 66ms    │ 83ms    │ 111ms   │ 152ms   │ 4.34s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/noindex     │ 200         │ 690      │ 100.00% │ 119  │ 152ms │ 1636ms  │ 1850ms  │ 1961ms  │ 2020ms  │ 5.80s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/count(*)         │ 200         │ 1916     │ 100.00% │ 407  │ 58ms  │ 483ms   │ 557ms   │ 620ms   │ 682ms   │ 4.71s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/pages       │ 200         │ 14899    │ 100.00% │ 3435 │ 6ms   │ 58ms    │ 62ms    │ 65ms    │ 136ms   │ 4.34s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴─────────┴─────────┴─────────┴─────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬─────────┬─────────┬─────────┬─────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%     │ 90%     │ 99%     │ Max     │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/complicated  │ 400         │ 431      │ 94.90%  │ 22   │ 59ms  │ 17815ms │ 17822ms │ 18062ms │ 18063ms │ 18.30s    │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/write             │ 400         │ 4633     │ 100.00% │ 1000 │ 47ms  │ 223ms   │ 402ms   │ 4082ms  │ 4105ms  │ 4.63s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/rw                │ 400         │ 4207     │ 100.00% │ 912  │ 171ms │ 350ms   │ 385ms   │ 4316ms  │ 4586ms  │ 4.61s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/indexed      │ 400         │ 819      │ 100.00% │ 93   │ 30ms  │ 3596ms  │ 4350ms  │ 5205ms  │ 5216ms  │ 8.77s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/noindex      │ 400         │ 403      │ 99.75%  │ 10   │ 104ms │ 38186ms │ 38195ms │ 38202ms │ 38337ms │ 38.44s    │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/count(*)          │ 400         │ 3888     │ 100.00% │ 842  │ 46ms  │ 355ms   │ 380ms   │ 4282ms  │ 4305ms  │ 4.62s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/pages        │ 400         │ 15320    │ 100.00% │ 3486 │ 7ms   │ 112ms   │ 130ms   │ 146ms   │ 177ms   │ 4.39s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/complicated │ 400         │ 3459     │ 100.00% │ 713  │ 96ms  │ 542ms   │ 615ms   │ 675ms   │ 788ms   │ 4.85s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/write            │ 400         │ 29956    │ 100.00% │ 6872 │ 1ms   │ 74ms    │ 86ms    │ 104ms   │ 205ms   │ 4.36s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/rw               │ 400         │ 15228    │ 100.00% │ 3492 │ 41ms  │ 113ms   │ 125ms   │ 138ms   │ 250ms   │ 4.36s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/indexed     │ 400         │ 11721    │ 100.00% │ 2654 │ 15ms  │ 148ms   │ 168ms   │ 189ms   │ 252ms   │ 4.42s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/noindex     │ 400         │ 1129     │ 59.43%  │ 103  │ 149ms │ 2014ms  │ 2523ms  │ 2693ms  │ 2802ms  │ 6.49s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/count(*)         │ 400         │ 1524     │ 100.00% │ 270  │ 100ms │ 1456ms  │ 1555ms  │ 1624ms  │ 1674ms  │ 5.65s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/pages       │ 400         │ 13622    │ 100.00% │ 3104 │ 9ms   │ 122ms   │ 137ms   │ 277ms   │ 355ms   │ 4.39s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴─────────┴─────────┴─────────┴─────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬─────────┬─────────┬─────────┬─────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%     │ 90%     │ 99%     │ Max     │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/complicated  │ 600         │ 629      │ 97.14%  │ 15   │ 87ms  │ 40834ms │ 40918ms │ 40932ms │ 40956ms │ 41.78s    │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/write             │ 600         │ 4816     │ 100.00% │ 1001 │ 103ms │ 258ms   │ 652ms   │ 4098ms  │ 4134ms  │ 4.81s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/rw                │ 600         │ 4185     │ 100.00% │ 882  │ 136ms │ 405ms   │ 429ms   │ 4718ms  │ 4734ms  │ 4.75s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/indexed      │ 600         │ 1245     │ 100.00% │ 163  │ 35ms  │ 3563ms  │ 3627ms  │ 4059ms  │ 5866ms  │ 7.64s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/noindex      │ 600         │ 608      │ 99.84%  │ 16   │ 74ms  │ 37698ms │ 37708ms │ 37716ms │ 38047ms │ 38.19s    │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/count(*)          │ 600         │ 8545     │ 100.00% │ 1880 │ 1ms   │ 311ms   │ 341ms   │ 4047ms  │ 4083ms  │ 4.54s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/pages        │ 600         │ 15644    │ 100.00% │ 3523 │ 14ms  │ 164ms   │ 201ms   │ 220ms   │ 419ms   │ 4.44s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/complicated │ 600         │ 3270     │ 100.00% │ 636  │ 84ms  │ 911ms   │ 1008ms  │ 1076ms  │ 1150ms  │ 5.14s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/write            │ 600         │ 22418    │ 100.00% │ 5126 │ 37ms  │ 112ms   │ 138ms   │ 163ms   │ 459ms   │ 4.37s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/rw               │ 600         │ 16422    │ 100.00% │ 3720 │ 28ms  │ 159ms   │ 173ms   │ 187ms   │ 441ms   │ 4.41s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/indexed     │ 600         │ 11244    │ 100.00% │ 2488 │ 24ms  │ 237ms   │ 261ms   │ 284ms   │ 316ms   │ 4.52s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/noindex     │ 600         │ 1854     │ 38.83%  │ 110  │ 202ms │ 2005ms  │ 2391ms  │ 2690ms  │ 2859ms  │ 6.52s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/count(*)         │ 600         │ 2073     │ 100.00% │ 349  │ 79ms  │ 1682ms  │ 1780ms  │ 1847ms  │ 1910ms  │ 5.93s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/pages       │ 600         │ 12998    │ 100.00% │ 2878 │ 10ms  │ 202ms   │ 213ms   │ 353ms   │ 370ms   │ 4.52s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴─────────┴─────────┴─────────┴─────────┴───────────┘
--------------------------------
┌────────────────────────────┬─────────────┬───────┬─────────┬──────┬─────┬───────┬───────┬───────┬───────┐
│ Name                       │ Concurrency │ Count │ Success │ RPS  │ Min │ 50%   │ 90%   │ Max   │ Time  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/complicated  │ 200         │ 247   │ 247     │ 25   │ 194 │ 7821  │ 7832  │ 8847  │ 9.76  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/complicated  │ 400         │ 431   │ 409     │ 22   │ 59  │ 17815 │ 17822 │ 18063 │ 18.30 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/complicated  │ 600         │ 629   │ 611     │ 15   │ 87  │ 40834 │ 40918 │ 40956 │ 41.78 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write             │ 200         │ 4305  │ 4305    │ 984  │ 41  │ 168   │ 195   │ 3692  │ 4.37  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write             │ 400         │ 4633  │ 4633    │ 1000 │ 47  │ 223   │ 402   │ 4105  │ 4.63  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write             │ 600         │ 4816  │ 4816    │ 1001 │ 103 │ 258   │ 652   │ 4134  │ 4.81  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                │ 200         │ 3855  │ 3855    │ 881  │ 96  │ 222   │ 274   │ 848   │ 4.38  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                │ 400         │ 4207  │ 4207    │ 912  │ 171 │ 350   │ 385   │ 4586  │ 4.61  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                │ 600         │ 4185  │ 4185    │ 882  │ 136 │ 405   │ 429   │ 4734  │ 4.75  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed      │ 200         │ 835   │ 835     │ 167  │ 17  │ 1504  │ 1541  │ 2618  │ 4.99  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed      │ 400         │ 819   │ 819     │ 93   │ 30  │ 3596  │ 4350  │ 5216  │ 8.77  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed      │ 600         │ 1245  │ 1245    │ 163  │ 35  │ 3563  │ 3627  │ 5866  │ 7.64  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex      │ 200         │ 255   │ 242     │ 14   │ 81  │ 14428 │ 14437 │ 14441 │ 17.42 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex      │ 400         │ 403   │ 402     │ 10   │ 104 │ 38186 │ 38195 │ 38337 │ 38.44 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex      │ 600         │ 608   │ 607     │ 16   │ 74  │ 37698 │ 37708 │ 38047 │ 38.19 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/count(*)          │ 200         │ 4817  │ 4817    │ 1083 │ 11  │ 169   │ 189   │ 2915  │ 4.45  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/count(*)          │ 400         │ 3888  │ 3888    │ 842  │ 46  │ 355   │ 380   │ 4305  │ 4.62  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/count(*)          │ 600         │ 8545  │ 8545    │ 1880 │ 1   │ 311   │ 341   │ 4083  │ 4.54  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/pages        │ 200         │ 14892 │ 14892   │ 3439 │ 16  │ 56    │ 69    │ 105   │ 4.33  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/pages        │ 400         │ 15320 │ 15320   │ 3486 │ 7   │ 112   │ 130   │ 177   │ 4.39  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/pages        │ 600         │ 15644 │ 15644   │ 3523 │ 14  │ 164   │ 201   │ 419   │ 4.44  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/complicated │ 200         │ 5021  │ 5021    │ 1116 │ 1   │ 225   │ 282   │ 420   │ 4.50  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/complicated │ 400         │ 3459  │ 3459    │ 713  │ 96  │ 542   │ 615   │ 788   │ 4.85  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/complicated │ 600         │ 3270  │ 3270    │ 636  │ 84  │ 911   │ 1008  │ 1150  │ 5.14  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/write            │ 200         │ 23772 │ 23772   │ 5519 │ 17  │ 35    │ 42    │ 287   │ 4.31  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/write            │ 400         │ 29956 │ 29956   │ 6872 │ 1   │ 74    │ 86    │ 205   │ 4.36  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/write            │ 600         │ 22418 │ 22418   │ 5126 │ 37  │ 112   │ 138   │ 459   │ 4.37  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/rw               │ 200         │ 17402 │ 17402   │ 4029 │ 22  │ 48    │ 54    │ 149   │ 4.32  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/rw               │ 400         │ 15228 │ 15228   │ 3492 │ 41  │ 113   │ 125   │ 250   │ 4.36  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/rw               │ 600         │ 16422 │ 16422   │ 3720 │ 28  │ 159   │ 173   │ 441   │ 4.41  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed     │ 200         │ 12866 │ 12866   │ 2966 │ 16  │ 66    │ 83    │ 152   │ 4.34  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed     │ 400         │ 11721 │ 11721   │ 2654 │ 15  │ 148   │ 168   │ 252   │ 4.42  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed     │ 600         │ 11244 │ 11244   │ 2488 │ 24  │ 237   │ 261   │ 316   │ 4.52  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex     │ 200         │ 690   │ 690     │ 119  │ 152 │ 1636  │ 1850  │ 2020  │ 5.80  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex     │ 400         │ 1129  │ 671     │ 103  │ 149 │ 2014  │ 2523  │ 2802  │ 6.49  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex     │ 600         │ 1854  │ 720     │ 110  │ 202 │ 2005  │ 2391  │ 2859  │ 6.52  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/count(*)         │ 200         │ 1916  │ 1916    │ 407  │ 58  │ 483   │ 557   │ 682   │ 4.71  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/count(*)         │ 400         │ 1524  │ 1524    │ 270  │ 100 │ 1456  │ 1555  │ 1674  │ 5.65  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/count(*)         │ 600         │ 2073  │ 2073    │ 349  │ 79  │ 1682  │ 1780  │ 1910  │ 5.93  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/pages       │ 200         │ 14899 │ 14899   │ 3435 │ 6   │ 58    │ 62    │ 136   │ 4.34  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/pages       │ 400         │ 13622 │ 13622   │ 3104 │ 9   │ 122   │ 137   │ 355   │ 4.39  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/pages       │ 600         │ 12998 │ 12998   │ 2878 │ 10  │ 202   │ 213   │ 370   │ 4.52  │
└────────────────────────────┴─────────────┴───────┴─────────┴──────┴─────┴───────┴───────┴───────┴───────┘
--------------------------------
┌────────────────────────────┬──────────┬──────────┬──────────┬───────┬─────────┬─────┬───────┬───────┬───────┬───────┐
│ Name                       │ 200C RPS │ 400C RPS │ 600C RPS │ Count │ Success │ Min │ 50%   │ 90%   │ Max   │ Time  │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/complicated  │ 25       │ 22       │ 15       │ 436   │ 97%     │ 113 │ 22157 │ 22191 │ 22622 │ 69.84 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write             │ 984      │ 1000     │ 1001     │ 4585  │ 100%    │ 64  │ 216   │ 416   │ 3977  │ 13.81 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                │ 881      │ 912      │ 882      │ 4082  │ 100%    │ 134 │ 326   │ 363   │ 3389  │ 13.74 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed      │ 167      │ 93       │ 163      │ 966   │ 100%    │ 27  │ 2888  │ 3173  │ 4567  │ 21.40 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex      │ 14       │ 10       │ 16       │ 422   │ 99%     │ 86  │ 30104 │ 30113 │ 30275 │ 94.05 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/count(*)          │ 1083     │ 842      │ 1880     │ 5750  │ 100%    │ 19  │ 278   │ 303   │ 3768  │ 13.61 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/pages        │ 3439     │ 3486     │ 3523     │ 15285 │ 100%    │ 12  │ 111   │ 133   │ 234   │ 13.16 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/complicated │ 1116     │ 713      │ 636      │ 3917  │ 100%    │ 60  │ 559   │ 635   │ 786   │ 14.49 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/write            │ 5519     │ 6872     │ 5126     │ 25382 │ 100%    │ 18  │ 74    │ 89    │ 317   │ 13.04 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/rw               │ 4029     │ 3492     │ 3720     │ 16351 │ 100%    │ 30  │ 107   │ 117   │ 280   │ 13.09 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed     │ 2966     │ 2654     │ 2488     │ 11944 │ 100%    │ 18  │ 150   │ 171   │ 240   │ 13.28 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex     │ 119      │ 103      │ 110      │ 1224  │ 57%     │ 168 │ 1885  │ 2255  │ 2560  │ 18.81 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/count(*)         │ 407      │ 270      │ 349      │ 1838  │ 100%    │ 79  │ 1207  │ 1297  │ 1422  │ 16.29 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/pages       │ 3435     │ 3104     │ 2878     │ 13840 │ 100%    │ 8   │ 127   │ 137   │ 287   │ 13.25 │
└────────────────────────────┴──────────┴──────────┴──────────┴───────┴─────────┴─────┴───────┴───────┴───────┴───────┘
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/1-RPS-vs-Concurrency.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/2-Degradation-Trend.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/3-Top10-Max-RPS.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/4-Top10-Lowest-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/5-RPS-vs-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/6-Performance-Radar.png
Server Version: unknown
Platform: linux
CPU Cores: 8
Memory (GB): 16
Total Time: 342.772s
🧠 Ask OpenAI for analysis...

✅ Analysis report:

## 接口性能概览

本报告分析了 Node.js 服务在不同并发下，使用 SQLite 和 PostgreSQL 数据库的多个接口的性能表现。压测数据显示，PostgreSQL 数据库在大多数接口上表现出显著优于 SQLite 数据库的性能。  SQLite 数据库的 `/sqlite3/read/complicated`、`/sqlite3/read/noindex` 接口在并发增加时，RPS 增长缓慢，延迟大幅增加，表现最差。PostgreSQL 数据库的 `/postgres/read/noindex` 接口也存在类似问题，但程度相对较轻。  `/sqlite3/write` 和 `/postgres/write` 接口的 RPS 随并发增加而增长，但增长速度在高并发下有所放缓，暗示潜在的瓶颈。其他读接口，特别是那些使用了索引的接口，在两种数据库中都表现良好。

## 问题诊断

**1. SQLite 数据库性能瓶颈:**

* **`/sqlite3/read/complicated` 和 `/sqlite3/read/noindex` 接口:**  这两个接口的 RPS 增长极度缓慢，延迟在高并发下急剧增加。这强烈暗示 SQLite 数据库本身的性能瓶颈。SQLite 作为单进程数据库，在高并发下容易出现锁竞争和资源争用。`complicated` 接口可能由于复杂的 SQL 查询导致性能下降，而 `noindex` 接口则由于缺乏索引导致全表扫描，性能极差。P99 远高于 P90 也佐证了这一点，说明存在少数极慢的请求拖慢整体性能。

* **`/sqlite3/write` 接口:**  虽然 RPS 较高，但在高并发下增长速度放缓，P99 延迟也显著增加。这可能是由于 SQLite 的写操作锁机制导致的并发限制，以及磁盘 I/O 成为瓶颈。

* **整体 SQLite 性能:**  与 PostgreSQL 相比，SQLite 在所有接口上的表现都明显逊色，这与 SQLite 的架构限制有关。它不适合高并发、高负载的场景。

**2. PostgreSQL 数据库性能瓶颈:**

* **`/postgres/read/noindex` 接口:**  类似于 SQLite 的无索引读接口，该接口在高并发下延迟增加，RPS 增长缓慢，这同样是由于缺乏索引导致全表扫描。

* **写接口的轻微瓶颈:** `/postgres/write` 接口在高并发下 RPS 增长速度略有下降，这可能是由于数据库连接池、网络 I/O 或数据库内部资源限制导致的。


**3. 整体系统瓶颈:**

在高并发下，SQLite 数据库成为整个系统的瓶颈。  PostgreSQL 数据库在高并发下也能保持较高的吞吐量，但部分接口也显示出轻微的瓶颈迹象，这需要进一步排查。单进程 Node.js 应用本身也可能成为瓶颈，尤其是在处理大量数据库请求时。


## 优化建议

**1. 数据库选择和优化:**

* **替换 SQLite:**  对于高并发应用，强烈建议将 SQLite 替换为 PostgreSQL 或其他更适合高并发场景的数据库，例如 MySQL。SQLite 不适合处理高并发请求，其单进程架构限制了其性能上限。

* **索引优化:**  对于 `/sqlite3/read/noindex` 和 `/postgres/read/noindex` 接口，必须添加合适的索引。分析查询语句，确定需要添加哪些索引以提高查询效率。

* **数据库连接池:**  使用数据库连接池来管理数据库连接，避免频繁创建和销毁连接，减少资源消耗。

* **SQL 优化:**  对于 `/sqlite3/read/complicated` 接口，分析并优化复杂的 SQL 查询语句，使其更高效。考虑使用 EXPLAIN PLAN 来分析查询计划。

* **数据库参数调整:**  根据压测结果，调整 PostgreSQL 数据库的参数，例如连接池大小、缓存大小等，以优化性能。


**2. 应用层优化:**

* **异步处理:**  使用异步编程模型（如 async/await 或 Promise）来处理数据库请求，避免阻塞主线程。

* **缓存:**  引入缓存机制（如 Redis）来缓存频繁访问的数据，减少数据库访问次数。

* **限流:**  在高并发情况下，使用限流机制来限制请求速率，防止系统过载。

* **负载均衡:**  如果需要更高的吞吐量，可以考虑使用负载均衡器将请求分发到多个 Node.js 实例。

* **进程模型:**  考虑使用集群模式（如 PM2 或 cluster 模块）来充分利用多核 CPU 资源。


**3. 代码优化:**

* **代码审查:**  对代码进行审查，找出潜在的性能瓶颈，例如不必要的循环、冗余计算等。

* **Profiling:**  使用 Node.js 的性能分析工具（如 Node.js Profiler）来找出代码中的性能瓶颈。


**4. 部署优化:**

* **硬件升级:**  如果资源不足，可以考虑升级服务器硬件，例如增加 CPU 内核、内存和磁盘 I/O 性能。


## 优先级排序

1. **替换 SQLite 为 PostgreSQL:**  这是最重要的优化措施，因为它直接解决了数据库的性能瓶颈。

2. **添加索引:**  为 `/sqlite3/read/noindex` 和 `/postgres/read/noindex` 接口添加索引，显著提高查询效率。

3. **优化复杂的 SQL 查询:**  优化 `/sqlite3/read/complicated` 接口的 SQL 查询，减少数据库负载。

4. **使用异步处理:**  使用异步编程模型来处理数据库请求，提高并发处理能力。

5. **引入缓存:**  缓存频繁访问的数据，减少数据库访问次数。

6. **使用连接池:**  优化数据库连接管理，减少资源消耗。


## 分析总结

本次压测结果清晰地表明了 SQLite 数据库在高并发场景下的性能瓶颈。  PostgreSQL 数据库在大多数情况下表现更好，但仍然存在一些需要优化的点。  通过数据库选择、索引优化、异步处理、缓存、限流等措施，可以显著提升系统的整体性能和并发处理能力。  建议使用 APM 工具（如 New Relic, Datadog）监控系统运行状况，并结合数据库 Profiler (例如 pgAdmin 的查询分析功能) 进一步定位和优化数据库性能。  此外，使用 tracing 工具 (例如 Jaeger, Zipkin) 可以追踪请求的完整链路，帮助识别更细粒度的性能问题。

--------------------------------
✅ Benchmark finished, all results are saved in benchmark-output folder
--------------------------------
