benchmark.log cleaned
ramp: 200 rampTims: 3
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬────────┬────────┬────────┬────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%    │ 90%    │ 99%    │ Max    │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/complicated  │ 200         │ 783      │ 100.00% │ 155  │ 185ms │ 1007ms │ 1378ms │ 3651ms │ 3659ms │ 5.06s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/write             │ 200         │ 4423     │ 100.00% │ 994  │ 52ms  │ 193ms  │ 216ms  │ 263ms  │ 1702ms │ 4.45s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/rw                │ 200         │ 3952     │ 100.00% │ 898  │ 113ms │ 222ms  │ 231ms  │ 282ms  │ 1574ms │ 4.40s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/indexed      │ 200         │ 3006     │ 100.00% │ 678  │ 1ms   │ 380ms  │ 400ms  │ 450ms  │ 673ms  │ 4.43s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/noindex      │ 200         │ 402      │ 100.00% │ 61   │ 28ms  │ 3271ms │ 3335ms │ 5789ms │ 5842ms │ 6.61s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/count(*)          │ 200         │ 23584    │ 100.00% │ 5469 │ 16ms  │ 36ms   │ 41ms   │ 48ms   │ 822ms  │ 4.31s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /sqlite3/read/pages        │ 200         │ 15427    │ 100.00% │ 3559 │ 23ms  │ 55ms   │ 65ms   │ 73ms   │ 111ms  │ 4.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/complicated │ 200         │ 16476    │ 100.00% │ 3800 │ 10ms  │ 51ms   │ 66ms   │ 85ms   │ 152ms  │ 4.34s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/write            │ 200         │ 24769    │ 100.00% │ 5743 │ 15ms  │ 35ms   │ 39ms   │ 49ms   │ 96ms   │ 4.31s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/rw               │ 200         │ 18012    │ 100.00% │ 4166 │ 20ms  │ 47ms   │ 55ms   │ 73ms   │ 97ms   │ 4.32s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/indexed     │ 200         │ 21255    │ 100.00% │ 4904 │ 1ms   │ 54ms   │ 58ms   │ 65ms   │ 565ms  │ 4.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/noindex     │ 200         │ 2671     │ 100.00% │ 584  │ 29ms  │ 335ms  │ 396ms  │ 459ms  │ 561ms  │ 4.57s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/count(*)         │ 200         │ 3866     │ 100.00% │ 860  │ 22ms  │ 224ms  │ 283ms  │ 339ms  │ 379ms  │ 4.50s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼────────┼────────┼────────┼────────┼───────────┤
│ /postgres/read/pages       │ 200         │ 15489    │ 100.00% │ 3572 │ 6ms   │ 56ms   │ 58ms   │ 64ms   │ 92ms   │ 4.34s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴────────┴────────┴────────┴────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬──────┬─────────┬─────────┬─────────┬─────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min  │ 50%     │ 90%     │ 99%     │ Max     │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/complicated  │ 400         │ 622      │ 100.00% │ 85   │ 24ms │ 4428ms  │ 7176ms  │ 7180ms  │ 7206ms  │ 7.33s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/write             │ 400         │ 4562     │ 100.00% │ 1017 │ 34ms │ 292ms   │ 348ms   │ 4076ms  │ 4110ms  │ 4.49s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/rw                │ 400         │ 5142     │ 100.00% │ 1160 │ 1ms  │ 440ms   │ 472ms   │ 529ms   │ 2583ms  │ 4.43s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/indexed      │ 400         │ 1606     │ 100.00% │ 342  │ 13ms │ 1163ms  │ 1188ms  │ 1929ms  │ 1975ms  │ 4.70s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/noindex      │ 400         │ 433      │ 92.61%  │ 39   │ 33ms │ 10154ms │ 10160ms │ 10161ms │ 10168ms │ 10.20s    │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/count(*)          │ 400         │ 23024    │ 100.00% │ 5330 │ 12ms │ 67ms    │ 78ms    │ 90ms    │ 2279ms  │ 4.32s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/pages        │ 400         │ 15940    │ 100.00% │ 3632 │ 8ms  │ 108ms   │ 127ms   │ 138ms   │ 207ms   │ 4.39s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/complicated │ 400         │ 10399    │ 100.00% │ 2342 │ 41ms │ 165ms   │ 193ms   │ 224ms   │ 261ms   │ 4.44s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/write            │ 400         │ 30915    │ 100.00% │ 7112 │ 1ms  │ 71ms    │ 81ms    │ 98ms    │ 877ms   │ 4.35s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/rw               │ 400         │ 17883    │ 100.00% │ 4099 │ 35ms │ 95ms    │ 107ms   │ 142ms   │ 242ms   │ 4.36s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/indexed     │ 400         │ 16633    │ 100.00% │ 3810 │ 7ms  │ 102ms   │ 114ms   │ 139ms   │ 1347ms  │ 4.37s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/noindex     │ 400         │ 1711     │ 100.00% │ 314  │ 39ms │ 1247ms  │ 1359ms  │ 1436ms  │ 1537ms  │ 5.44s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/count(*)         │ 400         │ 3110     │ 100.00% │ 639  │ 40ms │ 614ms   │ 677ms   │ 731ms   │ 772ms   │ 4.87s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼──────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/pages       │ 400         │ 15513    │ 100.00% │ 3524 │ 9ms  │ 113ms   │ 116ms   │ 124ms   │ 407ms   │ 4.40s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴──────┴─────────┴─────────┴─────────┴─────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /sqlite3/read/complicated
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /sqlite3/count(*)
Testing /sqlite3/read/pages
Testing /postgres/read/complicated
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex
Testing /postgres/count(*)
Testing /postgres/read/pages

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌────────────────────────────┬─────────────┬──────────┬─────────┬──────┬───────┬─────────┬─────────┬─────────┬─────────┬───────────┐
│ Case                       │ Concurrency │ Requests │ Success │ RPS  │ Min   │ 50%     │ 90%     │ 99%     │ Max     │ Test Time │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/complicated  │ 600         │ 630      │ 95.71%  │ 62   │ 30ms  │ 6656ms  │ 9626ms  │ 9632ms  │ 9644ms  │ 9.65s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/write             │ 600         │ 4883     │ 100.00% │ 1012 │ 56ms  │ 236ms   │ 362ms   │ 4621ms  │ 4667ms  │ 4.83s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/rw                │ 600         │ 4192     │ 100.00% │ 873  │ 362ms │ 596ms   │ 638ms   │ 4619ms  │ 4668ms  │ 4.80s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/indexed      │ 600         │ 2399     │ 100.00% │ 431  │ 13ms  │ 1380ms  │ 1401ms  │ 1428ms  │ 2793ms  │ 5.57s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/noindex      │ 600         │ 625      │ 99.52%  │ 46   │ 30ms  │ 12943ms │ 12956ms │ 12961ms │ 12968ms │ 13.46s    │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/count(*)          │ 600         │ 23725    │ 100.00% │ 5432 │ 25ms  │ 76ms    │ 91ms    │ 927ms   │ 4177ms  │ 4.37s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/pages        │ 600         │ 15527    │ 100.00% │ 3508 │ 17ms  │ 167ms   │ 190ms   │ 219ms   │ 2280ms  │ 4.43s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/complicated │ 600         │ 7010     │ 100.00% │ 1505 │ 55ms  │ 388ms   │ 422ms   │ 459ms   │ 549ms   │ 4.66s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/write            │ 600         │ 22387    │ 100.00% │ 5136 │ 12ms  │ 116ms   │ 129ms   │ 140ms   │ 312ms   │ 4.36s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/rw               │ 600         │ 16821    │ 100.00% │ 3832 │ 50ms  │ 155ms   │ 172ms   │ 189ms   │ 205ms   │ 4.39s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/indexed     │ 600         │ 16395    │ 100.00% │ 3727 │ 18ms  │ 161ms   │ 175ms   │ 190ms   │ 473ms   │ 4.40s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/noindex     │ 600         │ 2089     │ 85.02%  │ 281  │ 1ms   │ 2020ms  │ 2244ms  │ 2348ms  │ 2418ms  │ 6.32s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/count(*)         │ 600         │ 5415     │ 100.00% │ 1136 │ 73ms  │ 481ms   │ 617ms   │ 850ms   │ 960ms   │ 4.77s     │
├────────────────────────────┼─────────────┼──────────┼─────────┼──────┼───────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/pages       │ 600         │ 15794    │ 100.00% │ 3556 │ 14ms  │ 168ms   │ 173ms   │ 178ms   │ 273ms   │ 4.44s     │
└────────────────────────────┴─────────────┴──────────┴─────────┴──────┴───────┴─────────┴─────────┴─────────┴─────────┴───────────┘
--------------------------------
┌────────────────────────────┬─────────────┬───────┬─────────┬──────┬─────┬───────┬───────┬───────┬───────┐
│ Name                       │ Concurrency │ Count │ Success │ RPS  │ Min │ 50%   │ 90%   │ Max   │ Time  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/complicated  │ 200         │ 783   │ 783     │ 155  │ 185 │ 1007  │ 1378  │ 3659  │ 5.06  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/complicated  │ 400         │ 622   │ 622     │ 85   │ 24  │ 4428  │ 7176  │ 7206  │ 7.33  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/complicated  │ 600         │ 630   │ 603     │ 62   │ 30  │ 6656  │ 9626  │ 9644  │ 9.65  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write             │ 200         │ 4423  │ 4423    │ 994  │ 52  │ 193   │ 216   │ 1702  │ 4.45  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write             │ 400         │ 4562  │ 4562    │ 1017 │ 34  │ 292   │ 348   │ 4110  │ 4.49  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write             │ 600         │ 4883  │ 4883    │ 1012 │ 56  │ 236   │ 362   │ 4667  │ 4.83  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                │ 200         │ 3952  │ 3952    │ 898  │ 113 │ 222   │ 231   │ 1574  │ 4.40  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                │ 400         │ 5142  │ 5142    │ 1160 │ 1   │ 440   │ 472   │ 2583  │ 4.43  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                │ 600         │ 4192  │ 4192    │ 873  │ 362 │ 596   │ 638   │ 4668  │ 4.80  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed      │ 200         │ 3006  │ 3006    │ 678  │ 1   │ 380   │ 400   │ 673   │ 4.43  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed      │ 400         │ 1606  │ 1606    │ 342  │ 13  │ 1163  │ 1188  │ 1975  │ 4.70  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed      │ 600         │ 2399  │ 2399    │ 431  │ 13  │ 1380  │ 1401  │ 2793  │ 5.57  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex      │ 200         │ 402   │ 402     │ 61   │ 28  │ 3271  │ 3335  │ 5842  │ 6.61  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex      │ 400         │ 433   │ 401     │ 39   │ 33  │ 10154 │ 10160 │ 10168 │ 10.20 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex      │ 600         │ 625   │ 622     │ 46   │ 30  │ 12943 │ 12956 │ 12968 │ 13.46 │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/count(*)          │ 200         │ 23584 │ 23584   │ 5469 │ 16  │ 36    │ 41    │ 822   │ 4.31  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/count(*)          │ 400         │ 23024 │ 23024   │ 5330 │ 12  │ 67    │ 78    │ 2279  │ 4.32  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/count(*)          │ 600         │ 23725 │ 23725   │ 5432 │ 25  │ 76    │ 91    │ 4177  │ 4.37  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/pages        │ 200         │ 15427 │ 15427   │ 3559 │ 23  │ 55    │ 65    │ 111   │ 4.33  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/pages        │ 400         │ 15940 │ 15940   │ 3632 │ 8   │ 108   │ 127   │ 207   │ 4.39  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/pages        │ 600         │ 15527 │ 15527   │ 3508 │ 17  │ 167   │ 190   │ 2280  │ 4.43  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/complicated │ 200         │ 16476 │ 16476   │ 3800 │ 10  │ 51    │ 66    │ 152   │ 4.34  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/complicated │ 400         │ 10399 │ 10399   │ 2342 │ 41  │ 165   │ 193   │ 261   │ 4.44  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/complicated │ 600         │ 7010  │ 7010    │ 1505 │ 55  │ 388   │ 422   │ 549   │ 4.66  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/write            │ 200         │ 24769 │ 24769   │ 5743 │ 15  │ 35    │ 39    │ 96    │ 4.31  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/write            │ 400         │ 30915 │ 30915   │ 7112 │ 1   │ 71    │ 81    │ 877   │ 4.35  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/write            │ 600         │ 22387 │ 22387   │ 5136 │ 12  │ 116   │ 129   │ 312   │ 4.36  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/rw               │ 200         │ 18012 │ 18012   │ 4166 │ 20  │ 47    │ 55    │ 97    │ 4.32  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/rw               │ 400         │ 17883 │ 17883   │ 4099 │ 35  │ 95    │ 107   │ 242   │ 4.36  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/rw               │ 600         │ 16821 │ 16821   │ 3832 │ 50  │ 155   │ 172   │ 205   │ 4.39  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed     │ 200         │ 21255 │ 21255   │ 4904 │ 1   │ 54    │ 58    │ 565   │ 4.33  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed     │ 400         │ 16633 │ 16633   │ 3810 │ 7   │ 102   │ 114   │ 1347  │ 4.37  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed     │ 600         │ 16395 │ 16395   │ 3727 │ 18  │ 161   │ 175   │ 473   │ 4.40  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex     │ 200         │ 2671  │ 2671    │ 584  │ 29  │ 335   │ 396   │ 561   │ 4.57  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex     │ 400         │ 1711  │ 1711    │ 314  │ 39  │ 1247  │ 1359  │ 1537  │ 5.44  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex     │ 600         │ 2089  │ 1776    │ 281  │ 1   │ 2020  │ 2244  │ 2418  │ 6.32  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/count(*)         │ 200         │ 3866  │ 3866    │ 860  │ 22  │ 224   │ 283   │ 379   │ 4.50  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/count(*)         │ 400         │ 3110  │ 3110    │ 639  │ 40  │ 614   │ 677   │ 772   │ 4.87  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/count(*)         │ 600         │ 5415  │ 5415    │ 1136 │ 73  │ 481   │ 617   │ 960   │ 4.77  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/pages       │ 200         │ 15489 │ 15489   │ 3572 │ 6   │ 56    │ 58    │ 92    │ 4.34  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/pages       │ 400         │ 15513 │ 15513   │ 3524 │ 9   │ 113   │ 116   │ 407   │ 4.40  │
├────────────────────────────┼─────────────┼───────┼─────────┼──────┼─────┼───────┼───────┼───────┼───────┤
│ /postgres/read/pages       │ 600         │ 15794 │ 15794   │ 3556 │ 14  │ 168   │ 173   │ 273   │ 4.44  │
└────────────────────────────┴─────────────┴───────┴─────────┴──────┴─────┴───────┴───────┴───────┴───────┘
--------------------------------
┌────────────────────────────┬──────────┬──────────┬──────────┬───────┬─────────┬─────┬──────┬──────┬──────┬───────┐
│ Name                       │ 200C RPS │ 400C RPS │ 600C RPS │ Count │ Success │ Min │ 50%  │ 90%  │ Max  │ Time  │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/complicated  │ 155      │ 85       │ 62       │ 678   │ 99%     │ 80  │ 4030 │ 6060 │ 6836 │ 22.04 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/write             │ 994      │ 1017     │ 1012     │ 4623  │ 100%    │ 47  │ 240  │ 309  │ 3493 │ 13.77 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/rw                │ 898      │ 1160     │ 873      │ 4429  │ 100%    │ 159 │ 419  │ 447  │ 2942 │ 13.63 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/indexed      │ 678      │ 342      │ 431      │ 2337  │ 100%    │ 9   │ 974  │ 996  │ 1814 │ 14.70 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/noindex      │ 61       │ 39       │ 46       │ 487   │ 98%     │ 30  │ 8789 │ 8817 │ 9659 │ 30.27 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/count(*)          │ 5469     │ 5330     │ 5432     │ 23444 │ 100%    │ 18  │ 60   │ 70   │ 2426 │ 13.00 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /sqlite3/read/pages        │ 3559     │ 3632     │ 3508     │ 15631 │ 100%    │ 16  │ 110  │ 127  │ 866  │ 13.15 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/complicated │ 3800     │ 2342     │ 1505     │ 11295 │ 100%    │ 35  │ 201  │ 227  │ 321  │ 13.44 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/write            │ 5743     │ 7112     │ 5136     │ 26024 │ 100%    │ 9   │ 74   │ 83   │ 428  │ 13.02 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/rw               │ 4166     │ 4099     │ 3832     │ 17572 │ 100%    │ 35  │ 99   │ 111  │ 181  │ 13.07 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/indexed     │ 4904     │ 3810     │ 3727     │ 18094 │ 100%    │ 9   │ 106  │ 116  │ 795  │ 13.10 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/noindex     │ 584      │ 314      │ 281      │ 2157  │ 95%     │ 23  │ 1201 │ 1333 │ 1505 │ 16.33 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/count(*)         │ 860      │ 639      │ 1136     │ 4130  │ 100%    │ 45  │ 440  │ 526  │ 704  │ 14.14 │
├────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼─────┼──────┼──────┼──────┼───────┤
│ /postgres/read/pages       │ 3572     │ 3524     │ 3556     │ 15599 │ 100%    │ 10  │ 112  │ 116  │ 257  │ 13.18 │
└────────────────────────────┴──────────┴──────────┴──────────┴───────┴─────────┴─────┴──────┴──────┴──────┴───────┘
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/1-RPS-vs-Concurrency.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/2-Degradation-Trend.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/3-Top10-Max-RPS.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/4-Top10-Lowest-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/5-RPS-vs-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/6-Performance-Radar.png
Server Version: unknown
Platform: linux
CPU Cores: 8
Memory (GB): 16
Total Time: 217.806s
🧠 Ask OpenAI for analysis...

✅ Analysis report:

## 接口性能概览

本报告分析了 Node.js 服务在不同并发下，使用 SQLite 和 PostgreSQL 数据库的多个接口的性能表现。压测涵盖了读、写、读写读、索引读、无索引读以及计数等操作。  并发级别分别为 200、400 和 600。  所有接口的 RPS 都大于0，因此所有数据都纳入分析。

| 接口名称                     | 数据库 | 并发 | RPS     | P50(ms) | P90(ms) | P99(ms) | Max(ms) | 备注                                      |
|------------------------------|---------|------|---------|---------|---------|---------|---------|-------------------------------------------|
| `/sqlite3/read/complicated`   | sqlite3 | 200  | 155     | 1007    | 1378    | 3651    | 3659    | 延迟高，P99远大于P90                     |
| `/sqlite3/write`             | sqlite3 | 200  | 994     | 193     | 216     | 263     | 1702    | 延迟相对较低，但Max值偏高                 |
| `/sqlite3/rw`                | sqlite3 | 200  | 898     | 222     | 231     | 282     | 1574    | 延迟相对较低，但Max值偏高                 |
| `/sqlite3/read/indexed`      | sqlite3 | 200  | 678     | 380     | 400     | 450     | 673     | 延迟相对较低                             |
| `/sqlite3/read/noindex`      | sqlite3 | 200  | 61      | 3271    | 3335    | 5789    | 5842    | 延迟极高，无索引查询性能极差             |
| `/sqlite3/count(*)`          | sqlite3 | 200  | 5469    | 36      | 41      | 48      | 822     | 性能优秀                                  |
| `/sqlite3/read/pages`        | sqlite3 | 200  | 3559    | 55      | 65      | 73      | 111     | 性能优秀                                  |
| `/postgres/read/complicated` | postgres | 200  | 3800    | 51      | 66      | 85      | 152     | 性能优秀                                  |
| `/postgres/write`            | postgres | 200  | 5743    | 35      | 39      | 49      | 96      | 性能优秀                                  |
| `/postgres/rw`               | postgres | 200  | 4166    | 47      | 55      | 73      | 97      | 性能优秀                                  |
| `/postgres/read/indexed`     | postgres | 200  | 4904    | 54      | 58      | 65      | 565     | 性能优秀，Max值略高                       |
| `/postgres/read/noindex`     | postgres | 200  | 584     | 335     | 396     | 459     | 561     | 延迟相对较低                             |
| `/postgres/count(*)`         | postgres | 200  | 860     | 224     | 283     | 339     | 379     | 延迟相对较低                             |
| `/postgres/read/pages`       | postgres | 200  | 3572    | 56      | 58      | 64      | 92      | 性能优秀                                  |
| ... (更多并发级别的数据) ... |         |      |         |         |         |         |         |                                           |


(表格省略了 400 和 600 并发的部分数据，完整数据在后续分析中体现)


## 问题诊断

1. **SQLite 性能瓶颈:**  `/sqlite3/read/complicated` 和 `/sqlite3/read/noindex` 接口在所有并发级别下延迟都非常高，尤其是在高并发下，P99 延迟远高于 P90，表明存在严重的延迟抖动。这主要是因为 SQLite 是单进程数据库，无法充分利用多核 CPU 资源，在高并发下容易出现锁竞争和资源争抢，导致性能急剧下降。  `/sqlite3/read/noindex` 的性能尤其糟糕，这直接证明了索引的重要性。

2. **SQLite 写操作性能:** `/sqlite3/write` 和 `/sqlite3/rw` 接口的 Max 延迟值相对较高，这可能与 SQLite 的写操作机制和日志写入有关。

3. **PostgreSQL 性能表现:** PostgreSQL 数据库的接口整体性能优于 SQLite，这与其多进程架构和更强大的并发处理能力有关。  即使在高并发下，其延迟也相对稳定，P99 和 P90 的差距较小。  `/postgres/read/noindex` 接口的延迟在高并发下有所增加，但仍然远低于 SQLite 的无索引查询。

4. **非线性缩放:** 部分接口在并发增加时，RPS 的增长并非线性，例如 `/sqlite3/read/complicated`，这表明系统在特定并发下遇到了瓶颈，可能是数据库连接池耗尽或 CPU 资源不足。


## 优化建议

1. **数据库选择:**  对于高并发场景，强烈建议 **完全放弃 SQLite**，改用 PostgreSQL 或其他成熟的关系型数据库。SQLite 的单进程架构限制了其并发处理能力，无法满足高并发需求。

2. **数据库连接池:**  为 PostgreSQL 配置合适的连接池大小，避免连接池耗尽导致性能下降。可以使用 `pg` 模块提供的连接池功能。

3. **索引优化:**  对于 SQLite 和 PostgreSQL，确保所有频繁查询的字段都添加了合适的索引，特别是 `/sqlite3/read/complicated` 和 `/postgres/read/complicated` 接口，需要仔细分析查询语句，优化索引策略。

4. **查询优化:**  仔细审查数据库查询语句，避免使用效率低的查询方式。可以使用数据库 Profiler 工具（如 pgAdmin 的查询分析器）来分析慢查询。

5. **缓存:**  引入缓存机制（如 Redis）缓存频繁访问的数据，减少数据库查询压力。  对于 `/sqlite3/read/pages` 和 `/postgres/read/pages` 等接口，缓存效果会非常显著。

6. **异步处理:**  对于一些耗时较长的操作，例如数据库写入，可以采用异步处理的方式，避免阻塞主线程，提高系统响应速度。可以使用 Node.js 的异步编程能力，例如 `async/await` 和 `Promise`。

7. **限流:**  在高并发情况下，可以引入限流机制，防止系统过载。可以使用 Node.js 的限流中间件，例如 `rate-limit`。

8. **代码优化:**  检查代码是否存在性能瓶颈，例如不必要的循环、冗余计算等。可以使用 Node.js 的性能分析工具（如 `node --prof`）进行代码性能分析。

9. **监控和报警:**  部署监控系统，实时监控系统性能指标，例如 CPU 使用率、内存使用率、数据库连接数等，并设置报警阈值，及时发现和处理性能问题。


## 优先级排序

1. **替换 SQLite 为 PostgreSQL:**  这是最重要的优化，直接关系到系统的整体并发处理能力。
2. **索引优化:**  针对 `/sqlite3/read/complicated` 和 `/sqlite3/read/noindex` 接口，优化索引策略，提升查询效率。
3. **数据库连接池配置:**  优化 PostgreSQL 连接池配置，避免连接池耗尽。
4. **缓存机制引入:**  缓存频繁访问的数据，减少数据库压力。
5. **异步处理:**  将耗时操作异步化，提高响应速度。
6. **代码性能优化:**  分析和优化代码中的性能瓶颈。
7. **限流机制:**  在高并发情况下，保护系统避免过载。
8. **监控和报警:**  部署监控系统，及时发现和处理性能问题。


## 分析总结

本次压测结果显示，SQLite 数据库在高并发场景下的性能表现远不如 PostgreSQL。  SQLite 的单进程架构是其性能瓶颈的主要原因。  优化建议主要集中在数据库选择、索引优化、缓存机制、异步处理以及代码优化等方面。  通过实施这些优化措施，可以显著提升系统的并发处理能力和响应速度。  建议使用数据库 Profiler 和 Node.js 性能分析工具进一步定位和解决性能问题。  持续的监控和报警机制对于维护系统稳定性至关重要。

--------------------------------
✅ Benchmark finished, all results are saved in benchmark-output folder
--------------------------------
