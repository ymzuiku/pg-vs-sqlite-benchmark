benchmark.log cleaned
ramp: 200 rampTims: 3
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /better-sqlite3/read
Testing /better-sqlite3/write
Testing /better-sqlite3/rw
Testing /better-sqlite3/read/indexed
Testing /better-sqlite3/read/noindex
Testing /sqlite3/read
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /postgres/read
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌──────────────────────────────┬─────────────┬──────────┬─────────┬──────┬────────┬─────────┬─────────┬─────────┬─────────┬───────────┐
│ Case                         │ Concurrency │ Requests │ Success │ RPS  │ Min    │ 50%     │ 90%     │ 99%     │ Max     │ Test Time │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read         │ 200         │ 297      │ 84.18%  │ 28   │ 179ms  │ 4868ms  │ 6367ms  │ 6859ms  │ 8712ms  │ 8.89s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/write        │ 200         │ 9377     │ 100.00% │ 2269 │ 3ms    │ 43ms    │ 58ms    │ 2205ms  │ 4029ms  │ 4.13s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/rw           │ 200         │ 621      │ 100.00% │ 105  │ 16ms   │ 1617ms  │ 1650ms  │ 5858ms  │ 5910ms  │ 5.93s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read/indexed │ 200         │ 829      │ 100.00% │ 159  │ 11ms   │ 1237ms  │ 1292ms  │ 1325ms  │ 2533ms  │ 5.22s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read/noindex │ 200         │ 267      │ 74.91%  │ 17   │ 67ms   │ 8035ms  │ 11199ms │ 11965ms │ 12028ms │ 12.03s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read                │ 200         │ 237      │ 100.00% │ 32   │ 48ms   │ 6114ms  │ 6563ms  │ 7174ms  │ 7425ms  │ 7.49s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/write               │ 200         │ 4462     │ 100.00% │ 1076 │ 25ms   │ 151ms   │ 186ms   │ 1916ms  │ 3776ms  │ 4.15s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/rw                  │ 200         │ 522      │ 100.00% │ 89   │ 755ms  │ 1900ms  │ 2199ms  │ 3605ms  │ 3644ms  │ 5.85s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/indexed        │ 200         │ 916      │ 100.00% │ 180  │ 14ms   │ 989ms   │ 1019ms  │ 4837ms  │ 4993ms  │ 5.08s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/noindex        │ 200         │ 251      │ 90.04%  │ 18   │ 72ms   │ 11105ms │ 11114ms │ 11116ms │ 11117ms │ 12.64s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read               │ 200         │ 777      │ 100.00% │ 145  │ 29ms   │ 1361ms  │ 1388ms  │ 1394ms  │ 1414ms  │ 5.35s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/write              │ 200         │ 4325     │ 100.00% │ 1028 │ 16ms   │ 194ms   │ 203ms   │ 222ms   │ 224ms   │ 4.21s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/rw                 │ 200         │ 362      │ 100.00% │ 42   │ 1079ms │ 4374ms  │ 4719ms  │ 4729ms  │ 4729ms  │ 8.69s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/indexed       │ 200         │ 3087     │ 100.00% │ 723  │ 11ms   │ 274ms   │ 285ms   │ 296ms   │ 298ms   │ 4.27s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/noindex       │ 200         │ 370      │ 100.00% │ 50   │ 28ms   │ 3466ms  │ 4663ms  │ 4673ms  │ 4675ms  │ 7.41s     │
└──────────────────────────────┴─────────────┴──────────┴─────────┴──────┴────────┴─────────┴─────────┴─────────┴─────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /better-sqlite3/read
Testing /better-sqlite3/write
Testing /better-sqlite3/rw
Testing /better-sqlite3/read/indexed
Testing /better-sqlite3/read/noindex
Testing /sqlite3/read
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /postgres/read
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌──────────────────────────────┬─────────────┬──────────┬─────────┬──────┬────────┬─────────┬─────────┬─────────┬─────────┬───────────┐
│ Case                         │ Concurrency │ Requests │ Success │ RPS  │ Min    │ 50%     │ 90%     │ 99%     │ Max     │ Test Time │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read         │ 400         │ 502      │ 100.00% │ 26   │ 47ms   │ 9781ms  │ 17615ms │ 19453ms │ 19656ms │ 19.68s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/write        │ 400         │ 10729    │ 100.00% │ 2577 │ 4ms    │ 42ms    │ 58ms    │ 4095ms  │ 4116ms  │ 4.16s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/rw           │ 400         │ 811      │ 100.00% │ 120  │ 12ms   │ 2628ms  │ 3776ms  │ 6455ms  │ 6720ms  │ 6.73s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read/indexed │ 400         │ 1066     │ 100.00% │ 169  │ 18ms   │ 1774ms  │ 2316ms  │ 6248ms  │ 6310ms  │ 6.32s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read/noindex │ 400         │ 463      │ 86.39%  │ 17   │ 70ms   │ 14670ms │ 22833ms │ 23774ms │ 23904ms │ 23.91s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read                │ 400         │ 421      │ 98.57%  │ 26   │ 49ms   │ 15108ms │ 15112ms │ 15112ms │ 15152ms │ 15.73s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/write               │ 400         │ 4382     │ 100.00% │ 1004 │ 41ms   │ 218ms   │ 443ms   │ 3758ms  │ 3890ms  │ 4.36s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/rw                  │ 400         │ 708      │ 100.00% │ 87   │ 601ms  │ 2987ms  │ 6858ms  │ 7534ms  │ 7621ms  │ 8.11s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/indexed        │ 400         │ 1157     │ 100.00% │ 198  │ 15ms   │ 2006ms  │ 2117ms  │ 5790ms  │ 5807ms  │ 5.83s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/noindex        │ 400         │ 429      │ 98.14%  │ 16   │ 73ms   │ 25651ms │ 25665ms │ 25667ms │ 25682ms │ 26.93s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read               │ 400         │ 1157     │ 100.00% │ 173  │ 1ms    │ 2692ms  │ 2712ms  │ 2727ms  │ 2734ms  │ 6.69s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/write              │ 400         │ 4505     │ 100.00% │ 1026 │ 27ms   │ 392ms   │ 404ms   │ 408ms   │ 409ms   │ 4.39s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/rw                 │ 400         │ 495      │ 100.00% │ 41   │ 2206ms │ 6923ms  │ 8824ms  │ 9654ms  │ 9727ms  │ 11.99s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/indexed       │ 400         │ 3271     │ 100.00% │ 722  │ 26ms   │ 548ms   │ 578ms   │ 588ms   │ 591ms   │ 4.53s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/noindex       │ 400         │ 614      │ 100.00% │ 48   │ 26ms   │ 5871ms  │ 7965ms  │ 8828ms  │ 8840ms  │ 12.83s    │
└──────────────────────────────┴─────────────┴──────────┴─────────┴──────┴────────┴─────────┴─────────┴─────────┴─────────┴───────────┘
Benchmarking http://localhost:3333


--- Testing endpoints in mode concurrent ---

Testing /better-sqlite3/read
Testing /better-sqlite3/write
Testing /better-sqlite3/rw
Testing /better-sqlite3/read/indexed
Testing /better-sqlite3/read/noindex
Testing /sqlite3/read
Testing /sqlite3/write
Testing /sqlite3/rw
Testing /sqlite3/read/indexed
Testing /sqlite3/read/noindex
Testing /postgres/read
Testing /postgres/write
Testing /postgres/rw
Testing /postgres/read/indexed
Testing /postgres/read/noindex

-----------------

Mode: concurrent - Concurrent Mode: Keeps concurrency level steady.
┌──────────────────────────────┬─────────────┬──────────┬─────────┬──────┬────────┬─────────┬─────────┬─────────┬─────────┬───────────┐
│ Case                         │ Concurrency │ Requests │ Success │ RPS  │ Min    │ 50%     │ 90%     │ 99%     │ Max     │ Test Time │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read         │ 600         │ 696      │ 100.00% │ 25   │ 53ms   │ 14510ms │ 24747ms │ 27308ms │ 27582ms │ 27.62s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/write        │ 600         │ 10495    │ 100.00% │ 2469 │ 1ms    │ 47ms    │ 65ms    │ 4168ms  │ 4200ms  │ 4.25s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/rw           │ 600         │ 993      │ 99.19%  │ 99   │ 12ms   │ 5025ms  │ 6029ms  │ 6041ms  │ 6071ms  │ 9.98s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read/indexed │ 600         │ 1226     │ 100.00% │ 155  │ 29ms   │ 1845ms  │ 7062ms  │ 7808ms  │ 7885ms  │ 7.92s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /better-sqlite3/read/noindex │ 600         │ 678      │ 88.50%  │ 17   │ 72ms   │ 20774ms │ 33024ms │ 35789ms │ 36206ms │ 36.22s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read                │ 600         │ 631      │ 99.05%  │ 24   │ 54ms   │ 14828ms │ 25779ms │ 25783ms │ 25810ms │ 25.85s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/write               │ 600         │ 6045     │ 100.00% │ 1338 │ 1ms    │ 272ms   │ 329ms   │ 4363ms  │ 4411ms  │ 4.52s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/rw                  │ 600         │ 629      │ 100.00% │ 88   │ 978ms  │ 5353ms  │ 6771ms  │ 6781ms  │ 7063ms  │ 7.17s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/indexed        │ 600         │ 1202     │ 100.00% │ 187  │ 17ms   │ 3041ms  │ 3101ms  │ 3363ms  │ 6211ms  │ 6.41s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /sqlite3/read/noindex        │ 600         │ 651      │ 97.85%  │ 17   │ 71ms   │ 34434ms │ 34446ms │ 34450ms │ 34453ms │ 36.63s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read               │ 600         │ 1193     │ 100.00% │ 148  │ 21ms   │ 4015ms  │ 4065ms  │ 4073ms  │ 4075ms  │ 8.07s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/write              │ 600         │ 5908     │ 100.00% │ 1299 │ 1ms    │ 574ms   │ 589ms   │ 595ms   │ 597ms   │ 4.55s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/rw                 │ 600         │ 602      │ 100.00% │ 40   │ 3972ms │ 9447ms  │ 13864ms │ 14867ms │ 14974ms │ 15.05s    │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/indexed       │ 600         │ 3341     │ 100.00% │ 691  │ 18ms   │ 840ms   │ 914ms   │ 931ms   │ 934ms   │ 4.83s     │
├──────────────────────────────┼─────────────┼──────────┼─────────┼──────┼────────┼─────────┼─────────┼─────────┼─────────┼───────────┤
│ /postgres/read/noindex       │ 600         │ 774      │ 100.00% │ 47   │ 26ms   │ 8679ms  │ 12382ms │ 12417ms │ 12420ms │ 16.40s    │
└──────────────────────────────┴─────────────┴──────────┴─────────┴──────┴────────┴─────────┴─────────┴─────────┴─────────┴───────────┘
--------------------------------
┌──────────────────────────────┬─────────────┬───────┬─────────┬──────┬──────┬───────┬───────┬───────┬───────┐
│ Name                         │ Concurrency │ Count │ Success │ RPS  │ Min  │ 50%   │ 90%   │ Max   │ Time  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read         │ 200         │ 297   │ 250     │ 28   │ 179  │ 4868  │ 6367  │ 8712  │ 8.89  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read         │ 400         │ 502   │ 502     │ 26   │ 47   │ 9781  │ 17615 │ 19656 │ 19.68 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read         │ 600         │ 696   │ 696     │ 25   │ 53   │ 14510 │ 24747 │ 27582 │ 27.62 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/write        │ 200         │ 9377  │ 9377    │ 2269 │ 3    │ 43    │ 58    │ 4029  │ 4.13  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/write        │ 400         │ 10729 │ 10729   │ 2577 │ 4    │ 42    │ 58    │ 4116  │ 4.16  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/write        │ 600         │ 10495 │ 10495   │ 2469 │ 1    │ 47    │ 65    │ 4200  │ 4.25  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/rw           │ 200         │ 621   │ 621     │ 105  │ 16   │ 1617  │ 1650  │ 5910  │ 5.93  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/rw           │ 400         │ 811   │ 811     │ 120  │ 12   │ 2628  │ 3776  │ 6720  │ 6.73  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/rw           │ 600         │ 993   │ 985     │ 99   │ 12   │ 5025  │ 6029  │ 6071  │ 9.98  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read/indexed │ 200         │ 829   │ 829     │ 159  │ 11   │ 1237  │ 1292  │ 2533  │ 5.22  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read/indexed │ 400         │ 1066  │ 1066    │ 169  │ 18   │ 1774  │ 2316  │ 6310  │ 6.32  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read/indexed │ 600         │ 1226  │ 1226    │ 155  │ 29   │ 1845  │ 7062  │ 7885  │ 7.92  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read/noindex │ 200         │ 267   │ 200     │ 17   │ 67   │ 8035  │ 11199 │ 12028 │ 12.03 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read/noindex │ 400         │ 463   │ 400     │ 17   │ 70   │ 14670 │ 22833 │ 23904 │ 23.91 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read/noindex │ 600         │ 678   │ 600     │ 17   │ 72   │ 20774 │ 33024 │ 36206 │ 36.22 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read                │ 200         │ 237   │ 237     │ 32   │ 48   │ 6114  │ 6563  │ 7425  │ 7.49  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read                │ 400         │ 421   │ 415     │ 26   │ 49   │ 15108 │ 15112 │ 15152 │ 15.73 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read                │ 600         │ 631   │ 625     │ 24   │ 54   │ 14828 │ 25779 │ 25810 │ 25.85 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write               │ 200         │ 4462  │ 4462    │ 1076 │ 25   │ 151   │ 186   │ 3776  │ 4.15  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write               │ 400         │ 4382  │ 4382    │ 1004 │ 41   │ 218   │ 443   │ 3890  │ 4.36  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write               │ 600         │ 6045  │ 6045    │ 1338 │ 1    │ 272   │ 329   │ 4411  │ 4.52  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                  │ 200         │ 522   │ 522     │ 89   │ 755  │ 1900  │ 2199  │ 3644  │ 5.85  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                  │ 400         │ 708   │ 708     │ 87   │ 601  │ 2987  │ 6858  │ 7621  │ 8.11  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                  │ 600         │ 629   │ 629     │ 88   │ 978  │ 5353  │ 6771  │ 7063  │ 7.17  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed        │ 200         │ 916   │ 916     │ 180  │ 14   │ 989   │ 1019  │ 4993  │ 5.08  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed        │ 400         │ 1157  │ 1157    │ 198  │ 15   │ 2006  │ 2117  │ 5807  │ 5.83  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed        │ 600         │ 1202  │ 1202    │ 187  │ 17   │ 3041  │ 3101  │ 6211  │ 6.41  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex        │ 200         │ 251   │ 226     │ 18   │ 72   │ 11105 │ 11114 │ 11117 │ 12.64 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex        │ 400         │ 429   │ 421     │ 16   │ 73   │ 25651 │ 25665 │ 25682 │ 26.93 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex        │ 600         │ 651   │ 637     │ 17   │ 71   │ 34434 │ 34446 │ 34453 │ 36.63 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read               │ 200         │ 777   │ 777     │ 145  │ 29   │ 1361  │ 1388  │ 1414  │ 5.35  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read               │ 400         │ 1157  │ 1157    │ 173  │ 1    │ 2692  │ 2712  │ 2734  │ 6.69  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read               │ 600         │ 1193  │ 1193    │ 148  │ 21   │ 4015  │ 4065  │ 4075  │ 8.07  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/write              │ 200         │ 4325  │ 4325    │ 1028 │ 16   │ 194   │ 203   │ 224   │ 4.21  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/write              │ 400         │ 4505  │ 4505    │ 1026 │ 27   │ 392   │ 404   │ 409   │ 4.39  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/write              │ 600         │ 5908  │ 5908    │ 1299 │ 1    │ 574   │ 589   │ 597   │ 4.55  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/rw                 │ 200         │ 362   │ 362     │ 42   │ 1079 │ 4374  │ 4719  │ 4729  │ 8.69  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/rw                 │ 400         │ 495   │ 495     │ 41   │ 2206 │ 6923  │ 8824  │ 9727  │ 11.99 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/rw                 │ 600         │ 602   │ 602     │ 40   │ 3972 │ 9447  │ 13864 │ 14974 │ 15.05 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed       │ 200         │ 3087  │ 3087    │ 723  │ 11   │ 274   │ 285   │ 298   │ 4.27  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed       │ 400         │ 3271  │ 3271    │ 722  │ 26   │ 548   │ 578   │ 591   │ 4.53  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed       │ 600         │ 3341  │ 3341    │ 691  │ 18   │ 840   │ 914   │ 934   │ 4.83  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex       │ 200         │ 370   │ 370     │ 50   │ 28   │ 3466  │ 4663  │ 4675  │ 7.41  │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex       │ 400         │ 614   │ 614     │ 48   │ 26   │ 5871  │ 7965  │ 8840  │ 12.83 │
├──────────────────────────────┼─────────────┼───────┼─────────┼──────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex       │ 600         │ 774   │ 774     │ 47   │ 26   │ 8679  │ 12382 │ 12420 │ 16.40 │
└──────────────────────────────┴─────────────┴───────┴─────────┴──────┴──────┴───────┴───────┴───────┴───────┘
--------------------------------
┌──────────────────────────────┬──────────┬──────────┬──────────┬───────┬─────────┬──────┬───────┬───────┬───────┬───────┐
│ Name                         │ 200C RPS │ 400C RPS │ 600C RPS │ Count │ Success │ Min  │ 50%   │ 90%   │ Max   │ Time  │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read         │ 28       │ 26       │ 25       │ 498   │ 97%     │ 93   │ 9720  │ 16243 │ 18650 │ 56.19 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/write        │ 2269     │ 2577     │ 2469     │ 10200 │ 100%    │ 3    │ 44    │ 60    │ 4115  │ 12.54 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/rw           │ 105      │ 120      │ 99       │ 808   │ 100%    │ 13   │ 3090  │ 3818  │ 6234  │ 22.64 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read/indexed │ 159      │ 169      │ 155      │ 1040  │ 100%    │ 19   │ 1619  │ 3557  │ 5576  │ 19.46 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /better-sqlite3/read/noindex │ 17       │ 17       │ 17       │ 469   │ 85%     │ 70   │ 14493 │ 22352 │ 24046 │ 72.16 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read                │ 32       │ 26       │ 24       │ 430   │ 99%     │ 50   │ 12017 │ 15818 │ 16129 │ 49.07 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/write               │ 1076     │ 1004     │ 1338     │ 4963  │ 100%    │ 22   │ 214   │ 319   │ 4026  │ 13.03 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/rw                  │ 89       │ 87       │ 88       │ 620   │ 100%    │ 778  │ 3413  │ 5276  │ 6109  │ 21.13 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/indexed        │ 180      │ 198      │ 187      │ 1092  │ 100%    │ 15   │ 2012  │ 2079  │ 5670  │ 17.32 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /sqlite3/read/noindex        │ 18       │ 16       │ 17       │ 444   │ 96%     │ 72   │ 23730 │ 23742 │ 23751 │ 76.20 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read               │ 145      │ 173      │ 148      │ 1042  │ 100%    │ 17   │ 2689  │ 2722  │ 2741  │ 20.11 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/write              │ 1028     │ 1026     │ 1299     │ 4913  │ 100%    │ 15   │ 387   │ 399   │ 410   │ 13.15 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/rw                 │ 42       │ 41       │ 40       │ 486   │ 100%    │ 2419 │ 6915  │ 9136  │ 9810  │ 35.73 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read/indexed       │ 723      │ 722      │ 691      │ 3233  │ 100%    │ 18   │ 554   │ 592   │ 608   │ 13.63 │
├──────────────────────────────┼──────────┼──────────┼──────────┼───────┼─────────┼──────┼───────┼───────┼───────┼───────┤
│ /postgres/read/noindex       │ 50       │ 48       │ 47       │ 586   │ 100%    │ 27   │ 6005  │ 8337  │ 8645  │ 36.64 │
└──────────────────────────────┴──────────┴──────────┴──────────┴───────┴─────────┴──────┴───────┴───────┴───────┴───────┘
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/1-RPS-vs-Concurrency.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/2-Degradation-Trend.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/3-Top10-Max-RPS.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/4-Top10-Lowest-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/5-RPS-vs-t90.png
✅ Saved: /home/pillar/source/sql-vs-pg/benchmark-output/6-Performance-Radar.png
Server Version: unknown
Platform: linux
CPU Cores: 8
Memory (GB): 16
Total Time: 479.977s
🧠 Ask OpenAI for analysis...

✅ Analysis report:

## 接口性能概览

本报告分析了 Node.js 服务在不同并发下，使用 SQLite3, better-sqlite3 和 PostgreSQL 数据库的多个接口的性能表现。压测并发级别为 200, 400 和 600。  分析结果显示，PostgreSQL 数据库在大多数场景下表现最佳，而无索引读取操作在所有数据库中都成为性能瓶颈。

| 数据库 | 接口类型 | 并发 200 RPS | 并发 200 P99 (ms) | 并发 400 RPS | 并发 400 P99 (ms) | 并发 600 RPS | 并发 600 P99 (ms) | 索引影响 |
|---|---|---|---|---|---|---|---|---|
| better-sqlite3 | 读 | 28 | 6859 | 26 | 19453 | 25 | 27308 | 显著 |
| better-sqlite3 | 写 | 2269 | 2205 | 2577 | 4095 | 2469 | 4168 | 无影响 |
| better-sqlite3 | 读写读 | 105 | 5858 | 120 | 6455 | 99 | 6041 | 显著 |
| better-sqlite3 | 读(索引) | 159 | 1325 | 169 | 6248 | 155 | 7808 | 显著 |
| better-sqlite3 | 读(无索引) | 17 | 11965 | 17 | 23774 | 17 | 35789 | 显著 |
| sqlite3 | 读 | 32 | 7174 | 26 | 15112 | 24 | 25783 | 显著 |
| sqlite3 | 写 | 1076 | 1916 | 1004 | 3758 | 1338 | 4363 | 无影响 |
| sqlite3 | 读写读 | 89 | 3605 | 87 | 7534 | 88 | 6781 | 显著 |
| sqlite3 | 读(索引) | 180 | 4837 | 198 | 5790 | 187 | 3363 | 显著 |
| sqlite3 | 读(无索引) | 18 | 11116 | 16 | 25667 | 17 | 34450 | 显著 |
| PostgreSQL | 读 | 145 | 1394 | 173 | 2727 | 148 | 4073 | 显著 |
| PostgreSQL | 写 | 1028 | 222 | 1026 | 408 | 1299 | 595 | 无影响 |
| PostgreSQL | 读写读 | 42 | 4729 | 41 | 9654 | 40 | 14867 | 显著 |
| PostgreSQL | 读(索引) | 723 | 296 | 722 | 588 | 691 | 931 | 显著 |
| PostgreSQL | 读(无索引) | 50 | 4673 | 48 | 8828 | 47 | 12417 | 显著 |


## 问题诊断

1. **无索引读取操作的性能瓶颈:**  所有数据库的无索引读取接口(/read/noindex) 的 RPS 非常低，P99 延迟极高，并且随着并发增加，延迟呈指数级增长。这是因为数据库需要全表扫描来查找数据，导致 I/O 压力巨大。这是系统最严重的瓶颈。

2. **better-sqlite3 的读操作性能较差:**  与 sqlite3 和 PostgreSQL 相比，better-sqlite3 的读操作接口(/read) 的性能明显较差，P99 延迟很高，并且随着并发增加，延迟增长迅速。这可能是由于 better-sqlite3 的内部实现或与 Node.js 的交互效率问题。

3. **读写读操作的性能瓶颈:** 所有数据库的读写读操作接口(/rw) 的 P99 延迟都相对较高，并且随着并发增加，延迟增长明显。这可能是由于数据库事务处理或锁竞争导致的。

4. **单进程 Node.js 的限制:** 使用单进程 Node.js Express 服务处理高并发请求，容易导致单线程阻塞，无法充分利用多核 CPU 资源。这是系统整体性能的潜在瓶颈。

5. **数据库连接池不足 (潜在):**  虽然日志没有直接显示数据库连接池的指标，但高并发下数据库操作的延迟增加，暗示可能存在数据库连接池不足的情况，导致请求等待连接。


## 优化建议

1. **数据库索引优化:**  对所有数据库的读取操作，必须确保所有查询字段都已建立索引。尤其关注无索引读取接口，必须添加合适的索引。  可以使用数据库的 profiler 工具来分析查询语句的执行计划，确定需要添加哪些索引。

2. **数据库选择和连接池优化:**  PostgreSQL 在本次测试中表现最佳，建议优先考虑使用 PostgreSQL。同时，需要根据并发量调整数据库连接池大小，避免连接池耗尽。

3. **数据库连接复用:**  确保数据库连接得到有效复用，避免频繁创建和销毁连接。

4. **读写分离:**  对于读写操作频繁的接口，考虑采用读写分离的数据库架构，将读操作和写操作分摊到不同的数据库服务器上，减轻数据库压力。

5. **缓存机制:**  引入缓存机制 (例如 Redis) 来缓存频繁访问的数据，减少数据库查询次数。对于读操作，缓存可以显著提升性能。

6. **异步处理:**  使用异步编程模型 (例如 async/await 或 Promise) 来处理数据库操作和其他 I/O 密集型任务，避免阻塞主线程。

7. **集群部署:**  将 Node.js 服务部署到多台服务器上，实现水平扩展，提高系统吞吐量和并发处理能力。可以使用负载均衡器来分发请求。

8. **限流:**  在高并发情况下，可以引入限流机制来限制请求速率，防止系统过载。

9. **代码优化:**  检查数据库查询语句的效率，避免使用低效的查询方式。优化代码逻辑，减少不必要的计算和 I/O 操作。

10. **使用 APM 和 Tracing 工具:**  使用 APM (应用性能监控) 工具 (例如 New Relic, Datadog) 和 Tracing 工具 (例如 Jaeger, Zipkin) 来监控系统性能，定位性能瓶颈。


## 优先级排序

1. **添加数据库索引 (最高优先级):**  这是解决无索引读取接口性能瓶颈的关键步骤，能立即带来显著的性能提升。

2. **选择 PostgreSQL 并优化连接池:**  PostgreSQL 表现最佳，切换数据库并优化连接池可以提升整体性能。

3. **引入缓存机制:**  缓存可以显著减少数据库负载，提升读操作性能。

4. **异步处理数据库操作:**  避免阻塞主线程，提高并发处理能力。

5. **集群部署:**  水平扩展是应对高并发请求的有效手段。

6. **代码优化和数据库查询优化:**  精细化优化，进一步提升性能。

7. **限流:**  作为保护措施，防止系统过载。


## 分析总结

本次压测结果表明，系统在高并发下存在明显的性能瓶颈，主要体现在无索引读取操作和单进程 Node.js 服务的限制。通过数据库索引优化、选择合适的数据库、引入缓存机制、异步处理、集群部署等措施，可以显著提升系统性能和并发处理能力。  建议使用 APM 和 Tracing 工具进行持续监控和性能分析，以便及时发现和解决潜在问题。  更进一步，可以考虑使用更强大的数据库（如 MySQL 或 MongoDB），以及 Node.js 的集群方案（如 PM2 或 Cluster 模块）来充分利用多核 CPU 资源。

--------------------------------
✅ Benchmark finished, all results are saved in benchmark-output folder
--------------------------------
